import{bU as O,c9 as Q,r,j as t,F as $,ca as E,b as s,C as W,L as v,cb as Y,H as G}from"./index.5e55c1ba.js";const K=({showModal:i,handleClose:b,loaderModal:p,linkedData:o,handleDeleteData:e,dataId:N,moduleName:f,PropertyData:n,buildingData:c,projectName:j})=>t("div",{className:"thumbnail-container",children:i&&t("div",{className:"modal-overlay-property",children:s("div",{className:"modal-new w-[850px]",children:[s("div",{className:"flex items-center justify-between mb-[20px] pb-[7px] modal-border-bottom",children:[t("h5",{className:" text-[18px] capitalize",children:`Are You Sure you Want to Delete this ${f}?`}),t("img",{src:Y,alt:"cancelIcon",className:"w-[20px] cursor-pointer h-[20px]",onClick:b})]}),p===!0?t(E,{}):s($,{children:[o!=null&&o.length?t("div",{className:"data-list-modal",children:s($,{children:[s("h4",{className:"text-[16px] mb-[10px]",children:[t("span",{className:"font-bold",children:f})," ",j," is linked with the following modules:"]}),n!=null&&n.length?t("ul",{className:" mb-[10px] text-start",children:s("li",{className:"list-disc ml-[30px]",children:[t("span",{className:"font-semibold mr-[5px]",children:"Property: "}),n==null?void 0:n.map((l,d)=>s(v,{className:" mr-[5px] hover:underline",to:`/view-property/${l==null?void 0:l._id}?delete=true`,children:[l==null?void 0:l.unitnumber,d!==n.length-1?",":null]},d+1))]})}):null,c!=null&&c.length?t("ul",{className:" mb-[10px] text-start",children:s("li",{className:"list-disc ml-[30px]",children:[t("span",{className:"font-semibold mr-[5px]",children:"Building Name: "}),c==null?void 0:c.map((l,d)=>s(v,{className:" mr-[5px] hover:underline",to:`/view-building/${l==null?void 0:l._id}?delete=true`,children:[l==null?void 0:l.buildingname,d!==c.length-1?",":null]},d+1))]})}):null]})}):null,s("div",{className:"mb-[15px] max-h-[700px] pr-[15px]",children:[(o==null?void 0:o.length)||(n==null?void 0:n.length)||(c==null?void 0:c.length)?t("p",{className:" mt-[10px]",children:`This ${f} is already linked. Please first delete these entries which are linked it with`}):null,!(o!=null&&o.length)&&!(n!=null&&n.length)&&!(c!=null&&c.length)?t("button",{className:"btn btn inline-flex justify-center btn-danger ",onClick:()=>e(N),children:"Delete"}):null]})]})]})})}),P=()=>{const{id:i}=O(),b=localStorage.getItem("isAuth"),p=JSON.parse(b),{data:o}=Q(p==null?void 0:p.roleid),[e,N]=r.exports.useState(""),[f,n]=r.exports.useState(""),[c,j]=r.exports.useState(!1),l=new URLSearchParams(window.location.search),d=l.get("delete"),[q,y]=r.exports.useState(!1),[B,F]=r.exports.useState(""),[M,U]=r.exports.useState(""),[z,w]=r.exports.useState(!1),[g,I]=r.exports.useState(!1),[H,L]=r.exports.useState(!1),[V,S]=r.exports.useState(""),[_,C]=r.exports.useState("");r.exports.useEffect(()=>{(async()=>{if(i){const a=await(await fetch(`http://dev-rare.srp.ai/projectname/${i}`)).json();a&&N(a)}})()},[i]),r.exports.useEffect(()=>{(async()=>{if(e!=null&&e.communityid){const a=await(await fetch(`http://dev-rare.srp.ai/community/${e==null?void 0:e.communityid}`)).json();a&&n(a==null?void 0:a.communityname)}})()},[e==null?void 0:e.communityid]),r.exports.useEffect(()=>{d==="true"&&l&&(e==null?void 0:e.softdelete)===!1?j(!0):d==="true"&&l&&(e==null?void 0:e.softdelete)===!0&&(I(!0),j(!1))},[d,l,e==null?void 0:e.softdelete]);const T=async h=>{if(y(!0),w(!0),h)try{const m=`http://dev-rare.srp.ai/buildingname/api/projectnamedelete?projectnameid=${h}`,a=`http://dev-rare.srp.ai/property/api/advancesearch?projectnameid=${h}&softdelete=false`,u=await fetch(m);if(!u.ok&&u.status!==400)throw new Error(`API 1 failed with status: ${u.status}`);const k=u.status===400?[]:await u.json(),x=await fetch(a);if(!x.ok&&x.status!==400)throw new Error(`API 2 failed with status: ${x.status}`);const A=x.status===400?[]:await x.json(),J=[...k,...A];C(k),S(A),U(J),F(h),w(!1)}catch(m){console.error("Error fetching data:",m),w(!1)}};return t($,{children:H===!0?t(E,{}):s("div",{className:" space-y-5",children:[t(K,{showModal:q,handleClose:()=>{y(!1),S(""),C("")},loaderModal:z,linkedData:M,handleDeleteData:async()=>{try{await G.patch("http://dev-rare.srp.ai/projectname/api/projectdelete",{_id:i,softdelete:!0}),L(!0),(async()=>{if(i){const a=await(await fetch(`http://dev-rare.srp.ai/projectname/${i}`)).json();a&&N(a)}})(),S(""),C(""),I(!0),y(!1),w(!1),L(!1)}catch(h){console.log(h,"error")}},dataId:B,moduleName:"Project Name",PropertyData:V,buildingData:_,projectName:e==null?void 0:e.projectName}),t("div",{children:t("div",{children:s(W,{children:[s("div",{className:"flex justify-between items-center mb-6",children:[t("h4",{className:"card-title",children:"View Project"}),c===!0&&g===!1?t("button",{onClick:()=>T(i),className:"btn-dark py-[8px] px-[24px] rounded-[5px] flex items-center gap-x-[5px]",children:"Delete Project"}):null,g===!0&&c===!1?t("p",{className:"capitalize text-slate-500 dark:text-slate-400",children:"This Project is deleted"}):null]}),t("div",{children:t("div",{className:"flex z-[5] items-start relative justify-center",children:s("div",{className:"conten-box w-[100%]",children:[t("div",{children:s("div",{className:"grid lg:grid-cols-2 md:grid-cols-2 grid-cols-1 gap-5",children:[s("div",{children:[t("label",{htmlFor:"default-picker",className:" form-label",children:"Project Name"}),t("p",{className:"  form-control py-2   ",children:e!=null&&e.projectName?e==null?void 0:e.projectName:"Not Available"})]}),s("div",{children:[t("label",{htmlFor:"default-picker",className:" form-label",children:"Project Code"}),t("p",{className:"  form-control py-2   ",children:e!=null&&e.projectCode?e==null?void 0:e.projectCode:"Not Available"})]}),s("div",{children:[t("label",{htmlFor:"default-picker",className:" form-label",children:"Community Name"}),t("p",{className:"  form-control py-2   ",children:e!=null&&e.communityid?f:"Not Available"})]})]})}),c===!1&&g===!1?s("div",{className:"flex justify-end mt-10 text-right gap-x-[25px]",children:[t(v,{to:"/all-project",className:"btn btn inline-flex justify-center btn-secondary",children:"Back"}),(o==null?void 0:o.updateproject)&&t(v,{to:`/update-project/${i}`,className:"btn btn inline-flex justify-center btn-dark",children:"Edit"})]}):null]})})})]})})})]})})};export{P as default};
