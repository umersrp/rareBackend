import{r as C,ad as E,j as t,F as u,C as F,b as _,L as q,ca as D}from"./index.5e55c1ba.js";import{I as L,M as Q}from"./InvoicesTable.891a87d0.js";import"./Tooltip.4c4c7a86.js";/* empty css                     */import"./index.c89ffb9d.js";import"./GlobalFilter.2b1d860a.js";const z=()=>{const[i,w]=C.exports.useState([]),[j,o]=C.exports.useState(!1),x=localStorage.getItem("isAuth"),a=JSON.parse(x),h=E();C.exports.useEffect(()=>{o(!0),(async()=>{o(!0);try{const c=`http://dev-rare.srp.ai/property/api/advancesearch?customerid=${a==null?void 0:a._id}&sort=descending&type=customer&page=0&perPage=all`,M=`http://dev-rare.srp.ai/property/api/advancesearch?owner_representative_id=${a==null?void 0:a._id}&sort=descending&type=customer&page=0&perPage=all`,n=await fetch(c);if(!n.ok&&n.status!==400)throw new Error(`API 1 failed with status: ${n.status}`);const v=n.status===400?[]:await n.json(),r=await fetch(M);if(!r.ok&&r.status!==400)throw new Error(`API 2 failed with status: ${r.status}`);const y=r.status===400?[]:await r.json(),g=[...v,...y];if(h.pathname==="/owner-maintenancemanagement-invoices"){const d=g.map(e=>e._id).map(e=>fetch(`http://dev-rare.srp.ai/maintenancemanagement/api/q?propertyid=${e}&converted_invoice=true`).then(f=>f.json())),p=(await Promise.all(d)).filter(e=>e.message!=="No Maintenance Management found"),l=[].concat(...p),s=new Map;l.forEach(e=>{s.has(e==null?void 0:e._id)||s.set(e==null?void 0:e._id,e)});const m=[...Array.from(s.values())].reverse();w(m),o(!1)}else{const d=g.map(e=>e._id).map(e=>fetch(`http://dev-rare.srp.ai/maintenancemanagement/api/q?propertyid=${e}`).then(f=>f.json())),p=(await Promise.all(d)).filter(e=>e.message!=="No Maintenance Management found"),l=[].concat(...p),s=new Map;l.forEach(e=>{s.has(e==null?void 0:e._id)||s.set(e==null?void 0:e._id,e)});const m=[...Array.from(s.values())].reverse();w(m),o(!1)}}catch(c){console.error("Error fetching data:",c),o(!1)}})()},[h.pathname]);const N=()=>{o(!0),(async()=>{o(!0);try{const c=`http://dev-rare.srp.ai/property/api/advancesearch?customerid=${a==null?void 0:a._id}&sort=descending&type=customer&page=0&perPage=all`,M=`http://dev-rare.srp.ai/property/api/advancesearch?owner_representative_id=${a==null?void 0:a._id}&sort=descending&type=customer&page=0&perPage=all`,n=await fetch(c);if(!n.ok&&n.status!==400)throw new Error(`API 1 failed with status: ${n.status}`);const v=n.status===400?[]:await n.json(),r=await fetch(M);if(!r.ok&&r.status!==400)throw new Error(`API 2 failed with status: ${r.status}`);const y=r.status===400?[]:await r.json(),d=[...v,...y].map(e=>e._id).map(e=>fetch(`http://dev-rare.srp.ai/maintenancemanagement/api/q?propertyid=${e}`).then(f=>f.json())),p=(await Promise.all(d)).filter(e=>e.message!=="No Maintenance Management found"),l=[].concat(...p),s=new Map;l.forEach(e=>{s.has(e==null?void 0:e._id)||s.set(e==null?void 0:e._id,e)});const m=[...Array.from(s.values())].reverse();w(m),o(!1)}catch(c){console.error("Error fetching data:",c),o(!1)}})()};return t(u,{children:j===!1?t(u,{children:i!=null&&i.length?t("div",{className:" space-y-5",children:h.pathname==="/owner-maintenancemanagement-invoices"?t(L,{title:"All Maintenance Management Invoices",allData:i}):t(Q,{pagelink:"/maintenancemanagementform",linktitle:"Create Maintenance Management Quotations",title:"All Maintenance Management Quotations",allData:i,updateData:N})}):t(F,{children:h.pathname==="/owner-maintenancemanagement-invoices"?_(u,{children:[t("div",{className:"flex justify-between items-center mb-6",children:t("h4",{className:"card-title",children:"All Maintenance Management Invoices"})}),t("p",{children:"No Maintenance Management Invoices Found"})]}):_(u,{children:[_("div",{className:"flex justify-between items-center mb-6",children:[t("h4",{className:"card-title",children:"All Maintenance Management Quotations"}),t(q,{to:"/maintenancemanagementform",className:"btn-dark py-[8px] px-[24px] rounded-[5px]",children:"Add Maintenance Management Quotations"})]}),t("p",{children:"No Maintenance Management Quotations Found"})]})})}):t(D,{})})};export{z as default};
