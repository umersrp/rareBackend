import{R as A,j as l,F as S,r as c,C as be,am as L,I as M}from"./index.baa22cf8.js";import{r as p}from"./index.4b93aa2c.js";import{G as ve}from"./GlobalFilter.356989a9.js";import{D as pe}from"./index.esm.1fd6752e.js";var a="D:\\Ahsan\\Rare\\Dev\\Rare_Frontend\\src\\pages\\owner-pages\\booking\\ReportTable.jsx";const B=A.forwardRef(({indeterminate:f,...D},n)=>{const u=A.useRef(),b=n||u;return A.useEffect(()=>{b.current.indeterminate=f},[b,f]),l(S,{children:l("input",{type:"checkbox",ref:b,...D,className:"table-checkbox"},void 0,!1,{fileName:a,lineNumber:28,columnNumber:17},void 0)},void 0,!1)}),G={option:(f,D)=>({...f,fontSize:"14px"})},he=({title:f,allData:D})=>{const[n,u]=c.exports.useState([]),b=localStorage.getItem("isAuth"),r=JSON.parse(b),[h,z]=c.exports.useState();c.exports.useState();const[g,U]=c.exports.useState(),[N,_]=c.exports.useState({startDate:"",endDate:""}),V=e=>{_(e)},[P,q]=c.exports.useState([]);c.exports.useEffect(()=>{const e=async()=>{let t=[];for(let i of n)if(i!=null&&i.propertyid)try{const m=await(await fetch(`http://stg.srp.ai/property/${i.propertyid}`)).json();t.push(m)}catch(o){console.error(o)}q(t)};n.length&&e()},[n]);const[x,J]=c.exports.useState([]),[W,H]=c.exports.useState(!1);c.exports.useEffect(()=>{if(H(!0),P.length){const e=[...new Map(P.map(i=>[i._id,i])).values()],t=e==null?void 0:e.map(i=>({label:i.unitnumber+" | "+i.communityname+" | "+i.projectname,value:i._id}));H(!1),J(t)}},[P.length]);const[s,R]=c.exports.useState();c.exports.useEffect(()=>{(async()=>{try{const t=`http://stg.srp.ai/property/api/advancesearch?customerid=${r==null?void 0:r._id}&sort=descending&type=customer&page=0&perPage=all`,i=`http://stg.srp.ai/property/api/advancesearch?owner_representative_id=${r==null?void 0:r._id}&sort=descending&type=customer&page=0&perPage=all`,o=await fetch(t);if(!o.ok&&o.status!==400)throw new Error(`API 1 failed with status: ${o.status}`);const m=o.status===400?[]:await o.json(),d=await fetch(i);if(!d.ok&&d.status!==400)throw new Error(`API 2 failed with status: ${d.status}`);const C=d.status===400?[]:await d.json(),Ne=[...m,...C].map(v=>v._id).map(v=>fetch(`http://stg.srp.ai/booking/ownerrepresentative/pages?propertyid=${v}&page=0&perPage=all`).then(F=>F.json())),fe=(await Promise.all(Ne)).reduce((v,F)=>v.concat(F),[]);u(fe)}catch(t){console.error("Error fetching data:",t),setLoadingData(!1)}})()},[]);const[I,$]=c.exports.useState(!1),K=async()=>{if(N.startDate&&N.endDate){const t=await(await fetch(`http://stg.srp.ai/booking/api/reservationdate?ownerid=${r==null?void 0:r._id}&${s!=null&&s.propertyid?"propertyid="+(s==null?void 0:s.propertyid)+"&":""}fromDate=${N.startDate}&toDate=${N.endDate}`)).json();if($(!0),t!=null&&t.booking){const i=[];t.booking.forEach(o=>{(r==null?void 0:r._id)===o.ownerid&&i.push(o),u(i)})}else u([])}else{const t=await(await fetch(`http://stg.srp.ai/booking/pagination/pages?ownerid=${r==null?void 0:r._id}&propertyid=${s==null?void 0:s.propertyid}&page=0&perPage=all`)).json();if($(!0),t!=null&&t.booking){const i=[];t.booking.forEach(o=>{(r==null?void 0:r._id)===o.ownerid&&i.push(o),u(i)})}else u([])}},Q=async()=>{if(I===!0){const t=await(await fetch(`http://stg.srp.ai/booking/pagination/pages?ownerid=${r==null?void 0:r._id}&page=0&perPage=all`)).json();return $(!1),_({startDate:"",endDate:""}),R(),u(t==null?void 0:t.booking)}};c.exports.useEffect(()=>{var t;let e=0;for(let i=0;i<(n==null?void 0:n.length);i++){let o=parseInt((t=n[i])==null?void 0:t.nonight);e+=o}z(e)},[n==null?void 0:n.length]),c.exports.useEffect(()=>{var t;let e=0;for(let i=0;i<(n==null?void 0:n.length);i++){let o=parseInt((t=n[i])==null?void 0:t.roomrentamount);e+=o}U(e)},[n==null?void 0:n.length]);const X=[{Header:"Sr no",accessor:"id",Cell:({row:e,flatRows:t})=>l("span",{children:t.indexOf(e)+1},void 0,!1,{fileName:a,lineNumber:264,columnNumber:24},void 0)},{Header:"guest name",accessor:"guestname",Cell:e=>{var t,i,o,m,d;return l("span",{children:(t=e==null?void 0:e.cell)!=null&&t.value?((o=(i=e==null?void 0:e.cell)==null?void 0:i.value)==null?void 0:o.slice(0,15))+(((d=(m=e==null?void 0:e.cell)==null?void 0:m.value)==null?void 0:d.length)>15?"...":""):"Not Available"},void 0,!1,{fileName:a,lineNumber:271,columnNumber:24},void 0)}},{Header:"reservation date",accessor:"reservationdate",Cell:e=>{var t,i;return l("span",{children:(t=e==null?void 0:e.cell)!=null&&t.value?new Date((i=e==null?void 0:e.cell)==null?void 0:i.value).toDateString():"Not Available"},void 0,!1,{fileName:a,lineNumber:278,columnNumber:24},void 0)}},{Header:"Booking Ref#",accessor:"confirmationcode",Cell:e=>{var t,i,o,m;return l("div",{children:l("span",{className:"inline-flex items-center",children:l("span",{className:"text-sm text-slate-600 dark:text-slate-300 lowercase",children:(t=e==null?void 0:e.cell)!=null&&t.value?((i=e==null?void 0:e.cell)==null?void 0:i.value.slice(0,15))+(((m=(o=e==null?void 0:e.cell)==null?void 0:o.value)==null?void 0:m.length)>15?"...":""):"Not Available"},void 0,!1,{fileName:a,lineNumber:288,columnNumber:29},void 0)},void 0,!1,{fileName:a,lineNumber:287,columnNumber:25},void 0)},void 0,!1,{fileName:a,lineNumber:286,columnNumber:21},void 0)}},{Header:"checkin date",accessor:"checkindate",Cell:e=>{var t,i;return l("span",{children:(t=e==null?void 0:e.cell)!=null&&t.value?new Date((i=e==null?void 0:e.cell)==null?void 0:i.value).toDateString():"Not Available"},void 0,!1,{fileName:a,lineNumber:300,columnNumber:24},void 0)}},{Header:"checkout date",accessor:"checkoutdate",Cell:e=>{var t,i;return l("span",{children:(t=e==null?void 0:e.cell)!=null&&t.value?new Date((i=e==null?void 0:e.cell)==null?void 0:i.value).toDateString():"Not Available"},void 0,!1,{fileName:a,lineNumber:307,columnNumber:24},void 0)}},{id:"no nights stayed",Header:"no nights stayed",accessor:"nonight",Cell:e=>{var t,i;return l("span",{children:(t=e==null?void 0:e.cell)!=null&&t.value?(i=e==null?void 0:e.cell)==null?void 0:i.value:"Not Available"},void 0,!1,{fileName:a,lineNumber:315,columnNumber:24},void 0)}},{Header:"Rate per Day",accessor:"tourismfee",Cell:e=>{var t,i,o,m,d,C;return l("span",{children:parseInt(((o=(i=(t=e==null?void 0:e.cell)==null?void 0:t.row)==null?void 0:i.original)==null?void 0:o.roomrentamount)/((C=(d=(m=e==null?void 0:e.cell)==null?void 0:m.row)==null?void 0:d.original)==null?void 0:C.nonight)).toFixed(2)},void 0,!1,{fileName:a,lineNumber:322,columnNumber:24},void 0)}},{Header:"Booking Amount",accessor:"roomrentamount",Cell:e=>{var t,i;return l("span",{children:(t=e==null?void 0:e.cell)!=null&&t.value?parseInt((i=e==null?void 0:e.cell)==null?void 0:i.value).toFixed(2):"Not Available"},void 0,!1,{fileName:a,lineNumber:330,columnNumber:24},void 0)}}],Y=c.exports.useMemo(()=>X,[]),Z=c.exports.useMemo(()=>n),w=p.exports.useTable({columns:Y,data:Z,initialState:{pageIndex:0,pageSize:50}},p.exports.useGlobalFilter,p.exports.useSortBy,p.exports.usePagination,p.exports.useRowSelect,e=>{e.visibleColumns.push(t=>[{id:"selection",Header:({getToggleAllRowsSelectedProps:i})=>l("div",{children:l(B,{...i()},void 0,!1,{fileName:a,lineNumber:371,columnNumber:29},void 0)},void 0,!1,{fileName:a,lineNumber:370,columnNumber:25},void 0),Cell:({row:i})=>l("div",{children:l(B,{...i.getToggleRowSelectedProps()},void 0,!1,{fileName:a,lineNumber:376,columnNumber:29},void 0)},void 0,!1,{fileName:a,lineNumber:375,columnNumber:25},void 0)},...t])}),{getTableProps:ee,getTableBodyProps:le,headerGroups:ae,footerGroups:ge,page:te,nextPage:ie,previousPage:oe,canNextPage:y,canPreviousPage:k,pageOptions:E,state:re,gotoPage:j,pageCount:ne,setPageSize:se,setGlobalFilter:ce,prepareRow:me}=w,{globalFilter:de,pageIndex:T,pageSize:ue}=re;return l(S,{children:l(be,{children:[l("div",{className:"flex justify-between items-center mb-6",children:[l("h4",{className:"card-title",children:f},void 0,!1,{fileName:a,lineNumber:409,columnNumber:21},void 0),l("div",{className:"flex sm:space-x-4 space-x-2 sm:justify-end items-center rtl:space-x-reverse",children:[l("div",{className:"w-[400px] relative",children:W===!0?l(S,{children:[l("div",{className:"absolute w-[100%] z-10 h-[100%] opacity-[0.8]",style:{background:"#e2e8f0"},children:l("div",{className:"flex items-center justify-center h-[100%]",children:l("svg",{className:"animate-spin ltr:-ml-1 ltr:mr-3 rtl:-mr-1 rtl:ml-3 h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[l("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"},void 0,!1,{fileName:a,lineNumber:423,columnNumber:53},void 0),l("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},void 0,!1,{fileName:a,lineNumber:431,columnNumber:53},void 0)]},void 0,!0,{fileName:a,lineNumber:417,columnNumber:49},void 0)},void 0,!1,{fileName:a,lineNumber:416,columnNumber:45},void 0)},void 0,!1,{fileName:a,lineNumber:415,columnNumber:41},void 0),l(L,{label:"Basic Select",className:"react-select",classNamePrefix:"select",options:x,value:x.filter(function(e){return e.value===(s==null?void 0:s.propertyid)}),placeholder:"Select Property",onChange:e=>{R({propertyid:e==null?void 0:e.value,propertyname:e==null?void 0:e.label},"select box")},styles:G,id:"hh"},void 0,!1,{fileName:a,lineNumber:439,columnNumber:41},void 0)]},void 0,!0):l(L,{label:"Basic Select",className:"react-select",classNamePrefix:"select",options:x,value:x.filter(function(e){return e.value===(s==null?void 0:s.propertyid)}),placeholder:"Select Property",onChange:e=>{R({propertyid:e==null?void 0:e.value,propertyname:e==null?void 0:e.label},"select box")},styles:G,id:"hh"},void 0,!1,{fileName:a,lineNumber:455,columnNumber:37},void 0)},void 0,!1,{fileName:a,lineNumber:411,columnNumber:25},void 0),l("div",{className:"date-range-custom relative",children:l(pe,{value:N,inputClassName:"input-class",containerClassName:"container-class",onChange:V},void 0,!1,{fileName:a,lineNumber:473,columnNumber:29},void 0)},void 0,!1,{fileName:a,lineNumber:472,columnNumber:25},void 0),N.startDate&&N.endDate||(s==null?void 0:s.propertyid)?l("button",{className:"btn-dark py-[10px] px-[20px] rounded-[5px]",onClick:K,children:"Filter"},void 0,!1,{fileName:a,lineNumber:482,columnNumber:33},void 0):null,I===!0?l("button",{className:"btn-secondary py-[10px] px-[20px] rounded-[5px]",onClick:Q,children:"Reset"},void 0,!1,{fileName:a,lineNumber:486,columnNumber:33},void 0):null,l(ve,{filter:de,setFilter:ce},void 0,!1,{fileName:a,lineNumber:488,columnNumber:25},void 0)]},void 0,!0,{fileName:a,lineNumber:410,columnNumber:21},void 0)]},void 0,!0,{fileName:a,lineNumber:408,columnNumber:17},void 0),l("div",{className:"overflow-x-auto -mx-6",children:l("div",{className:"inline-block min-w-full align-middle",children:l("div",{className:"overflow-hidden ",children:l("table",{className:"min-w-full divide-y divide-slate-100 table-fixed dark:divide-slate-700",...ee,children:[l("thead",{className:"bg-slate-200 dark:bg-slate-700",children:ae.map(e=>l("tr",{...e.getHeaderGroupProps(),children:e.headers.map(t=>l("th",{...t.getHeaderProps(t.getSortByToggleProps()),scope:"col",className:" table-th ",children:[t.render("Header"),l("span",{children:t.isSorted?t.isSortedDesc?" \u{1F53D}":" \u{1F53C}":""},void 0,!1,{fileName:a,lineNumber:510,columnNumber:53},void 0)]},void 0,!0,{fileName:a,lineNumber:502,columnNumber:49},void 0))},void 0,!1,{fileName:a,lineNumber:500,columnNumber:41},void 0))},void 0,!1,{fileName:a,lineNumber:498,columnNumber:33},void 0),l("tbody",{className:"bg-white divide-y divide-slate-100 dark:bg-slate-800 dark:divide-slate-700",...le,children:[te.map(e=>(me(e),l("tr",{...e.getRowProps(),children:e.cells.map(t=>l("td",{...t.getCellProps(),className:"table-td",children:t.render("Cell")},void 0,!1,{fileName:a,lineNumber:532,columnNumber:57},void 0))},void 0,!1,{fileName:a,lineNumber:529,columnNumber:45},void 0))),l("tr",{children:[l("td",{className:"table-td font-bold",children:"TOTAL"},void 0,!1,{fileName:a,lineNumber:541,columnNumber:41},void 0),l("td",{},void 0,!1,{fileName:a,lineNumber:542,columnNumber:41},void 0),l("td",{},void 0,!1,{fileName:a,lineNumber:543,columnNumber:41},void 0),l("td",{},void 0,!1,{fileName:a,lineNumber:544,columnNumber:41},void 0),l("td",{},void 0,!1,{fileName:a,lineNumber:545,columnNumber:41},void 0),l("td",{},void 0,!1,{fileName:a,lineNumber:546,columnNumber:41},void 0),l("td",{},void 0,!1,{fileName:a,lineNumber:547,columnNumber:41},void 0),l("td",{className:"table-td font-bold",children:[h?h.toLocaleString():0," Nights"]},void 0,!0,{fileName:a,lineNumber:548,columnNumber:41},void 0),l("td",{className:"table-td font-bold",children:g&&h?Math.abs(g/h).toLocaleString():0},void 0,!1,{fileName:a,lineNumber:549,columnNumber:41},void 0),l("td",{className:"table-td font-bold",children:g?g.toLocaleString():0},void 0,!1,{fileName:a,lineNumber:550,columnNumber:41},void 0)]},void 0,!0,{fileName:a,lineNumber:540,columnNumber:37},void 0)]},void 0,!0,{fileName:a,lineNumber:522,columnNumber:33},void 0)]},void 0,!0,{fileName:a,lineNumber:494,columnNumber:29},void 0)},void 0,!1,{fileName:a,lineNumber:493,columnNumber:25},void 0)},void 0,!1,{fileName:a,lineNumber:492,columnNumber:21},void 0)},void 0,!1,{fileName:a,lineNumber:491,columnNumber:17},void 0),l("div",{className:"md:flex md:space-y-0 space-y-5 justify-between mt-6 items-center",children:[l("div",{className:" flex items-center space-x-3 rtl:space-x-reverse",children:[l("select",{className:"form-control py-2 w-max",value:ue,onChange:e=>se(Number(e.target.value)),children:[50,100,200].map(e=>l("option",{value:e,children:["Show ",e]},e,!0,{fileName:a,lineNumber:565,columnNumber:33},void 0))},void 0,!1,{fileName:a,lineNumber:559,columnNumber:25},void 0),l("span",{className:"text-sm font-medium text-slate-600 dark:text-slate-300",children:["Page"," ",l("span",{children:[T+1," of ",E.length]},void 0,!0,{fileName:a,lineNumber:572,columnNumber:29},void 0)]},void 0,!0,{fileName:a,lineNumber:570,columnNumber:25},void 0)]},void 0,!0,{fileName:a,lineNumber:558,columnNumber:21},void 0),l("ul",{className:"flex items-center  space-x-3  rtl:space-x-reverse",children:[l("li",{className:"text-xl leading-4 text-slate-900 dark:text-white rtl:rotate-180",children:l("button",{className:` ${k?"":"opacity-50 cursor-not-allowed"}`,onClick:()=>j(0),disabled:!k,children:l(M,{icon:"heroicons:chevron-double-left-solid"},void 0,!1,{fileName:a,lineNumber:585,columnNumber:33},void 0)},void 0,!1,{fileName:a,lineNumber:579,columnNumber:29},void 0)},void 0,!1,{fileName:a,lineNumber:578,columnNumber:25},void 0),l("li",{className:"text-sm leading-4 text-slate-900 dark:text-white rtl:rotate-180",children:l("button",{className:` ${k?"":"opacity-50 cursor-not-allowed"}`,onClick:()=>oe(),disabled:!k,children:"Prev"},void 0,!1,{fileName:a,lineNumber:589,columnNumber:29},void 0)},void 0,!1,{fileName:a,lineNumber:588,columnNumber:25},void 0),E.map((e,t)=>l("li",{children:l("button",{href:"#","aria-current":"page",className:` ${t===T?"bg-slate-900 dark:bg-slate-600  dark:text-slate-200 text-white font-medium ":"bg-slate-100 dark:bg-slate-700 dark:text-slate-400 text-slate-900  font-normal  "}    text-sm rounded leading-[16px] flex h-6 w-6 items-center justify-center transition-all duration-150`,onClick:()=>j(t),children:e+1},void 0,!1,{fileName:a,lineNumber:600,columnNumber:33},void 0)},t,!1,{fileName:a,lineNumber:599,columnNumber:29},void 0)),l("li",{className:"text-sm leading-4 text-slate-900 dark:text-white rtl:rotate-180",children:l("button",{className:` ${y?"":"opacity-50 cursor-not-allowed"}`,onClick:()=>ie(),disabled:!y,children:"Next"},void 0,!1,{fileName:a,lineNumber:614,columnNumber:29},void 0)},void 0,!1,{fileName:a,lineNumber:613,columnNumber:25},void 0),l("li",{className:"text-xl leading-4 text-slate-900 dark:text-white rtl:rotate-180",children:l("button",{onClick:()=>j(ne-1),disabled:!y,className:` ${y?"":"opacity-50 cursor-not-allowed"}`,children:l(M,{icon:"heroicons:chevron-double-right-solid"},void 0,!1,{fileName:a,lineNumber:630,columnNumber:33},void 0)},void 0,!1,{fileName:a,lineNumber:624,columnNumber:29},void 0)},void 0,!1,{fileName:a,lineNumber:623,columnNumber:25},void 0)]},void 0,!0,{fileName:a,lineNumber:577,columnNumber:21},void 0)]},void 0,!0,{fileName:a,lineNumber:557,columnNumber:17},void 0)]},void 0,!0,{fileName:a,lineNumber:407,columnNumber:13},void 0)},void 0,!1)};var O="D:\\Ahsan\\Rare\\Dev\\Rare_Frontend\\src\\pages\\owner-pages\\booking\\BookingReport.jsx";const Re=()=>l(S,{children:l("div",{className:" space-y-5",children:l(he,{title:"Booking Report"},void 0,!1,{fileName:O,lineNumber:9,columnNumber:17},void 0)},void 0,!1,{fileName:O,lineNumber:8,columnNumber:13},void 0)},void 0,!1);export{Re as default};
