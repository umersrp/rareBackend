import{R as Y,r,b as p,j as t,F as N,C as J,ap as K}from"./index.300fc045.js";import{D as Q}from"./index.esm.6d76aaaf.js";import"./jspdf.es.min.3e3f0040.js";import"./html2canvas.esm.0eae2bf4.js";var s="C:\\Users\\LENOVO\\Desktop\\rareProjects\\Rare_Frontend\\src\\pages\\tenant-contract\\summary-reports\\ReportTable.jsx";const $=Y.forwardRef(({allBooking:e,propertyData:n},C)=>{const x=i=>{const{contractstartdate:l,contractenddate:a}=i;let o=new Date(l),M=new Date(a);return(M.getFullYear()-o.getFullYear())*12+(M.getMonth()-o.getMonth())+" Months"},f=[{Header:"Sr no",accessor:"id",Cell:({row:i,flatRows:l})=>t("span",{children:l.indexOf(i)+1},void 0,!1,{fileName:s,lineNumber:29,columnNumber:24},void 0)},{Header:"Tenancy contract No",accessor:"tenantcontractno",Cell:i=>{var l,a;return t("span",{children:(l=i==null?void 0:i.cell)!=null&&l.value?(a=i==null?void 0:i.cell)==null?void 0:a.value:"Not Available"},void 0,!1,{fileName:s,lineNumber:36,columnNumber:24},void 0)}},{Header:"Status",accessor:i=>`${i.contractenddate}`,Cell:i=>{var l,a;return t("span",{className:"block w-full",children:t("span",{className:` inline-block px-3 min-w-[90px] text-center mx-auto py-1 rounded-[999px] bg-opacity-25 ${new Date((l=i==null?void 0:i.cell)==null?void 0:l.value)>new Date?"text-success-500 bg-success-500":"text-danger-500 bg-danger-500"} `,children:new Date((a=i==null?void 0:i.cell)==null?void 0:a.value)>new Date?"Active":"Expired"},void 0,!1,{fileName:s,lineNumber:45,columnNumber:25},void 0)},void 0,!1,{fileName:s,lineNumber:44,columnNumber:21},void 0)}},{Header:"Tenancy Start Date",accessor:"contractstartdate",Cell:i=>{var l,a;return t("span",{children:(l=i==null?void 0:i.cell)!=null&&l.value?new Date((a=i==null?void 0:i.cell)==null?void 0:a.value).toDateString():"Not Available"},void 0,!1,{fileName:s,lineNumber:62,columnNumber:24},void 0)}},{Header:"Tenancy Expiry Date",accessor:"contractenddate",Cell:i=>{var l,a;return t("span",{children:(l=i==null?void 0:i.cell)!=null&&l.value?new Date((a=i==null?void 0:i.cell)==null?void 0:a.value).toDateString():"Not Available"},void 0,!1,{fileName:s,lineNumber:71,columnNumber:24},void 0)}},{Header:"Tenancy Period",accessor:"refund",Cell:i=>{const{original:l}=i.row;return console.log("original",l),t("span",{children:l?x(l):"Not Available"},void 0,!1,{fileName:s,lineNumber:80,columnNumber:24},void 0)}},{Header:"Rental Amount",accessor:"rentalamount",Cell:i=>{var l,a,o;return t("span",{children:(l=i==null?void 0:i.cell)!=null&&l.value?((o=Number((a=i==null?void 0:i.cell)==null?void 0:a.value))==null?void 0:o.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0}))+" AED":"Not Available"},void 0,!1,{fileName:s,lineNumber:87,columnNumber:24},void 0)}}],P=r.exports.useMemo(()=>f,[]),h=r.exports.useMemo(()=>e),S=p.exports.useTable({columns:P,data:h,initialState:{pageIndex:0,pageSize:50}},p.exports.useGlobalFilter,p.exports.useSortBy,p.exports.usePagination,p.exports.useRowSelect),{getTableProps:g,getTableBodyProps:A,headerGroups:v,footerGroups:T,page:b,nextPage:H,previousPage:_,canNextPage:y,canPreviousPage:E,pageOptions:L,state:R,gotoPage:O,pageCount:j,setPageSize:m,setGlobalFilter:u,prepareRow:d}=S,[F,z]=r.exports.useState(0),[Z,G]=r.exports.useState(0),[w,U]=r.exports.useState(0),[D,I]=r.exports.useState(0),[k,q]=r.exports.useState(0),[B,V]=r.exports.useState(0);return r.exports.useEffect(()=>{if(e!=null&&e.length){const i=e.map(l=>{const{rentalamount:a}=l;return Number(a)});z(i.reduce((l,a)=>l+a,0))}},[e==null?void 0:e.length]),r.exports.useEffect(()=>{if(e!=null&&e.length){const i=e.map(l=>{const{totalNonight:a}=l;return a});G(i.reduce((l,a)=>l+a,0))}},[e==null?void 0:e.length]),r.exports.useEffect(()=>{if(e!=null&&e.length){const i=e.map(a=>{const{Occupancy:o}=a;return o});let l=Math.round(i.reduce((a,o)=>a+o,0)/i.length);I(l)}},[e==null?void 0:e.length]),r.exports.useEffect(()=>{var i;if(e!=null&&e.length){let l=0;for(let a=0;a<(e==null?void 0:e.length);a++){let o=parseFloat((i=e[a])==null?void 0:i.totalNonight);l+=o}q(l||0)}},[e==null?void 0:e.length]),r.exports.useEffect(()=>{var i;if(e!=null&&e.length){let l=0;for(let a=0;a<(e==null?void 0:e.length);a++){let o=parseFloat((i=e[a])==null?void 0:i.averageCost);l+=o}V(l||0)}},[e==null?void 0:e.length]),r.exports.useEffect(()=>{var i;if(e!=null&&e.length){let l=0;for(let a=0;a<(e==null?void 0:e.length);a++){let o=parseFloat((i=e[a])==null?void 0:i.totalhostpayble);l+=o}U(l||0)}},[e==null?void 0:e.length]),t(N,{children:e&&(e==null?void 0:e.length)>0?t(N,{children:t("div",{ref:C,children:[t("div",{className:"mt-[25px]",children:[t("div",{className:"flex gap-x-[10px]",children:[t("p",{className:"font-semibold",children:"Landlord Name: "},void 0,!1,{fileName:s,lineNumber:238,columnNumber:25},void 0),t("p",{className:"capitalize",children:n!=null&&n.owner_name?n==null?void 0:n.owner_name:"Not Available"},void 0,!1,{fileName:s,lineNumber:239,columnNumber:25},void 0)]},void 0,!0,{fileName:s,lineNumber:237,columnNumber:21},void 0),t("div",{className:"flex gap-x-[10px]",children:[t("p",{className:"font-semibold",children:"Community Name: "},void 0,!1,{fileName:s,lineNumber:242,columnNumber:25},void 0),t("p",{className:"capitalize",children:n!=null&&n.communityname?n==null?void 0:n.communityname:"Not Available"},void 0,!1,{fileName:s,lineNumber:243,columnNumber:25},void 0)]},void 0,!0,{fileName:s,lineNumber:241,columnNumber:21},void 0),t("div",{className:"flex gap-x-[10px]",children:[t("p",{className:"font-semibold",children:"Project Name: "},void 0,!1,{fileName:s,lineNumber:246,columnNumber:25},void 0),t("p",{className:"capitalize",children:n!=null&&n.project_name?n==null?void 0:n.project_name:"Not Available"},void 0,!1,{fileName:s,lineNumber:247,columnNumber:25},void 0)]},void 0,!0,{fileName:s,lineNumber:245,columnNumber:21},void 0),t("div",{className:"flex gap-x-[10px]",children:[t("p",{className:"font-semibold",children:"Apartment No: "},void 0,!1,{fileName:s,lineNumber:250,columnNumber:25},void 0),t("p",{className:"capitalize",children:n!=null&&n.unitnumber?n==null?void 0:n.unitnumber:"Not Available"},void 0,!1,{fileName:s,lineNumber:251,columnNumber:25},void 0)]},void 0,!0,{fileName:s,lineNumber:249,columnNumber:21},void 0),t("div",{className:"flex gap-x-[10px]",children:[t("p",{className:"font-semibold",children:"Building No: "},void 0,!1,{fileName:s,lineNumber:254,columnNumber:25},void 0),t("p",{className:"capitalize",children:n!=null&&n.building_name?n==null?void 0:n.building_name:"Not Available"},void 0,!1,{fileName:s,lineNumber:255,columnNumber:25},void 0)]},void 0,!0,{fileName:s,lineNumber:253,columnNumber:21},void 0)]},void 0,!0,{fileName:s,lineNumber:236,columnNumber:17},void 0),t("div",{className:"overflow-x-auto -mx-6 mt-6",children:t("div",{className:"inline-block min-w-full align-middle",children:t("div",{className:"",children:t("table",{className:"min-w-[100%] overflow-x-scroll divide-y divide-slate-100 table-fixed dark:divide-slate-700",...g,children:[t("thead",{className:"bg-slate-200 dark:bg-slate-700",children:v.map(i=>t("tr",{...i.getHeaderGroupProps(),children:i.headers.map(l=>t("th",{...l.getHeaderProps(l.getSortByToggleProps()),scope:"col",className:"table-th",children:[l.render("Header"),t("span",{children:l.isSorted?l.isSortedDesc?" \u{1F53D}":" \u{1F53C}":""},void 0,!1,{fileName:s,lineNumber:276,columnNumber:57},void 0)]},void 0,!0,{fileName:s,lineNumber:270,columnNumber:53},void 0))},void 0,!1,{fileName:s,lineNumber:267,columnNumber:41},void 0))},void 0,!1,{fileName:s,lineNumber:265,columnNumber:33},void 0),t("tbody",{className:"bg-white divide-y divide-slate-100 dark:bg-slate-800 dark:divide-slate-700",...A,children:[b&&b.length>0&&b.map(i=>(d(i),t(N,{children:t("tr",{...i.getRowProps(),children:i.cells.map(l=>t("td",{...l.getCellProps(),className:"table-td",children:l.render("Cell")},void 0,!1,{fileName:s,lineNumber:297,columnNumber:61},void 0))},void 0,!1,{fileName:s,lineNumber:294,columnNumber:49},void 0)},void 0,!1))),t("tr",{className:"borderBottom",children:[t("td",{},void 0,!1,{fileName:s,lineNumber:307,columnNumber:41},void 0),t("td",{},void 0,!1,{fileName:s,lineNumber:308,columnNumber:41},void 0),t("td",{},void 0,!1,{fileName:s,lineNumber:309,columnNumber:41},void 0),t("td",{},void 0,!1,{fileName:s,lineNumber:310,columnNumber:41},void 0),t("td",{},void 0,!1,{fileName:s,lineNumber:311,columnNumber:41},void 0),t("td",{className:"font-semibold",children:"GROSS RENT INCOME"},void 0,!1,{fileName:s,lineNumber:312,columnNumber:41},void 0),t("td",{className:"table-td font-semibold",children:(F==null?void 0:F.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0}))+" AED"},void 0,!1,{fileName:s,lineNumber:313,columnNumber:41},void 0)]},void 0,!0,{fileName:s,lineNumber:306,columnNumber:37},void 0)]},void 0,!0,{fileName:s,lineNumber:285,columnNumber:33},void 0)]},void 0,!0,{fileName:s,lineNumber:261,columnNumber:29},void 0)},void 0,!1,{fileName:s,lineNumber:260,columnNumber:25},void 0)},void 0,!1,{fileName:s,lineNumber:259,columnNumber:21},void 0)},void 0,!1,{fileName:s,lineNumber:258,columnNumber:17},void 0)]},void 0,!0,{fileName:s,lineNumber:235,columnNumber:13},void 0)},void 0,!1):t("div",{className:"pl-2",children:t("h6",{className:" text-base text-slate-800 dark:text-slate-300 mb-[0.5rem] mt-[0.5rem]",children:"No Property Data Found"},void 0,!1,{fileName:s,lineNumber:420,columnNumber:13},void 0)},void 0,!1,{fileName:s,lineNumber:419,columnNumber:13},void 0)},void 0,!1)}),W="/assets/RARE-Logo-animate.7e47c055.gif";var c="C:\\Users\\LENOVO\\Desktop\\rareProjects\\Rare_Frontend\\src\\pages\\tenant-contract\\summary-reports\\TenancyReport.jsx";const X={option:(e,n)=>({...e,fontSize:"14px"})},ae=()=>{var j;const[e,n]=r.exports.useState({propertyid:"",filteredDates:[]}),[C,x]=r.exports.useState([]),[f,P]=r.exports.useState(""),[h,S]=r.exports.useState(""),[g,A]=r.exports.useState(!1),[v,T]=r.exports.useState([]),[b,H]=r.exports.useState("");r.exports.useEffect(()=>{fetch("http://dev-rare.srp.ai/property").then(m=>m.json()).then(m=>{const u=m==null?void 0:m.map(d=>({label:d.unitnumber+" | "+d.communityname+" | "+d.projectname+" | "+d.buildingname,value:d._id}));T(u)})},[]),r.exports.useEffect(()=>{(async()=>{if(e!=null&&e.propertyid){const d=await(await fetch(`http://dev-rare.srp.ai/property/${e==null?void 0:e.propertyid}`)).json();d&&H(d)}})()},[e==null?void 0:e.propertyid]),r.exports.useEffect(()=>{(async()=>{const d=await(await fetch("http://dev-rare.srp.ai/booking")).json();P(d)})()},[]);const[_,y]=r.exports.useState({startDate:"",endDate:""}),E=r.exports.useRef(null),L=async()=>{const u=await(await fetch(`http://dev-rare.srp.ai/tenantcontract/tenantsummaryreport/${e.propertyid}`)).json();x(u.data),console.log("=============>",u)};r.exports.useEffect(()=>{if(f!=null&&f.length&&(e==null?void 0:e.propertyid)&&(e==null?void 0:e.startDate)&&(e==null?void 0:e.endDate)){const m=f.filter(u=>{let d=!0;return e.propertyid&&u.propertyid!==e.propertyid&&(d=!1),(u==null?void 0:u.checkindate)<(e==null?void 0:e.startDate)&&(u==null?void 0:u.checkindate)>(e==null?void 0:e.endDate)&&(d=!1),d});x(m)}L()},[e==null?void 0:e.propertyid,e==null?void 0:e.startDate,e==null?void 0:e.endDate,f]);const R=()=>{S(""),n({...e,filteredDates:[]}),y({startDate:null,endDate:null})},O=async m=>{if(console.log("newValue",m),A(!0),S(m),!m){n({...e,filteredDates:[]});return}const d=await(await fetch(`http://dev-rare.srp.ai/tenantcontract/report/${e.propertyid}?contractstartdate=${m.startDate}&contractenddate=${m.endDate}`)).json();A(!1),n({...e,filteredDates:d==null?void 0:d.data})};return t(N,{children:t("div",{className:"xl:col-span-2 col-span-1",children:t(J,{title:"Tenancy Summary",children:[t("div",{className:"flex flex-row-reverse"},void 0,!1,{fileName:c,lineNumber:173,columnNumber:21},void 0),t("div",{children:[t("form",{className:"lg:grid-cols-3 grid gap-5 grid-cols-1 ",children:[t("div",{className:"w-[100%] col-span-3",children:t("h4",{className:"text-base text-slate-800 dark:text-slate-300 mb-[0.5rem] mt-[0.5rem]",children:"Select Property"},void 0,!1,{fileName:c,lineNumber:182,columnNumber:33},void 0)},void 0,!1,{fileName:c,lineNumber:181,columnNumber:29},void 0),t("div",{className:"w-[100%] col-span-3",children:t(K,{label:"Basic Select",className:"react-select",classNamePrefix:"select",options:v,value:v&&h?v.filter(function(m){return m.value===(e==null?void 0:e.propertyid)}):v.filter(function(m){return m.value===(e==null?void 0:e.propertyid)}),onChange:m=>{h?R():n({...e,propertyid:m==null?void 0:m.value})},styles:X,id:"hh",placeholder:"Select and Search property"},void 0,!1,{fileName:c,lineNumber:190,columnNumber:33},void 0)},void 0,!1,{fileName:c,lineNumber:186,columnNumber:29},void 0)]},void 0,!0,{fileName:c,lineNumber:177,columnNumber:25},void 0),console.log("userData222=========HJKL=====>",e),e.propertyid&&t(N,{children:t("div",{className:"flex justify-end mt-[25px]",children:[t("div",{className:"w-[150px]",children:t("div",{className:"date-range-custom relative",children:t(Q,{value:_,inputClassName:"input-class",containerClassName:"container-class",onChange:O,placeholder:"SELECT DATE"},void 0,!1,{fileName:c,lineNumber:238,columnNumber:49},void 0)},void 0,!1,{fileName:c,lineNumber:237,columnNumber:45},void 0)},void 0,!1,{fileName:c,lineNumber:236,columnNumber:41},void 0),h&&t("div",{className:"flex justify-end",children:t("div",{className:"w-[90px]",children:t("div",{className:"date-range-custom relative",children:t("button",{className:"btn btn-dark text-white  text-center",type:"button",onClick:R,children:"Reset"},void 0,!1,{fileName:c,lineNumber:252,columnNumber:45},void 0)},void 0,!1,{fileName:c,lineNumber:251,columnNumber:45},void 0)},void 0,!1,{fileName:c,lineNumber:250,columnNumber:41},void 0)},void 0,!1,{fileName:c,lineNumber:249,columnNumber:25},void 0)]},void 0,!0,{fileName:c,lineNumber:235,columnNumber:37},void 0)},void 0,!1)]},void 0,!0,{fileName:c,lineNumber:176,columnNumber:21},void 0),g===!0?t(N,{children:t("div",{className:"flex items-center justify-center h-[100%]",children:t("img",{src:W,width:150,height:150},void 0,!1,{fileName:c,lineNumber:271,columnNumber:37},void 0)},void 0,!1,{fileName:c,lineNumber:270,columnNumber:33},void 0)},void 0,!1):(j=e==null?void 0:e.filteredDates)!=null&&j.length?t(N,{children:t($,{allBooking:e.filteredDates,propertyData:b,ref:E},void 0,!1,{fileName:c,lineNumber:277,columnNumber:33},void 0)},void 0,!1):t(N,{children:t($,{allBooking:C,propertyData:b,ref:E},void 0,!1,{fileName:c,lineNumber:282,columnNumber:33},void 0)},void 0,!1)]},void 0,!0,{fileName:c,lineNumber:172,columnNumber:17},void 0)},void 0,!1,{fileName:c,lineNumber:171,columnNumber:13},void 0)},void 0,!1)};export{ae as default};
