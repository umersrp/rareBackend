import{R as $,j as a,F as d,r as n,b as f,C as ne,ap as oe}from"./index.300fc045.js";import{L as Y}from"./Rare logo New Gif Loading.02c4dc82.js";import{T as se}from"./Table.252651eb.js";import{D as me}from"./index.esm.6d76aaaf.js";import"./jspdf.es.min.3e3f0040.js";import"./html2canvas.esm.0eae2bf4.js";import"./index.186db273.js";var l="C:\\Users\\LENOVO\\Desktop\\rareProjects\\Rare_Frontend\\src\\pages\\owner-pages\\tenancy-contract\\summaryReport\\TenantSummary.jsx";const q=$.forwardRef(({indeterminate:v,...D},p)=>{const S=$.useRef(),r=p||S;return $.useEffect(()=>{r.current.indeterminate=v},[r,v]),a(d,{children:a("input",{type:"checkbox",ref:r,...D,className:"table-checkbox"},void 0,!1,{fileName:l,lineNumber:33,columnNumber:17},void 0)},void 0,!1)}),ce={option:(v,D)=>({...v,fontSize:"14px"})},ge=({title:v,allData:D})=>{var O,M,z,U,B;const[p,S]=n.exports.useState([]),[r,A]=n.exports.useState([]),G=localStorage.getItem("isAuth"),u=JSON.parse(G),[de,J]=n.exports.useState();n.exports.useState(0),n.exports.useState(0),n.exports.useState();const[ue,K]=n.exports.useState(),[h,W]=n.exports.useState([]),[C,I]=n.exports.useState(!1),[Q,L]=n.exports.useState(!1);n.exports.useState();const[s,P]=n.exports.useState({propertyid:"",filteredDates:[]}),[X,Z]=n.exports.useState({startDate:"",endDate:""}),[k,_]=n.exports.useState("");console.log("selectedProperty",s);const w=async e=>{L(!0),_(e);const t=await(await fetch(`http://dev-rare.srp.ai/tenantcontract/report/${s.propertyid}?contractstartdate=${e.startDate}&contractenddate=${e.endDate}`)).json();L(!1),P({...s,filteredDates:t==null?void 0:t.data}),A(t==null?void 0:t.data)},[E,ee]=n.exports.useState([]);n.exports.useEffect(()=>{(async()=>{const t=await(await fetch(`http://dev-rare.srp.ai/tenantcontract/tenantsummaryreport/${s.propertyid}`)).json();A(t==null?void 0:t.data)})()},[s.propertyid]);const ae=e=>{const i=new Set;return e.filter(t=>i.has(t._id)?!1:(i.add(t._id),!0))};n.exports.useEffect(()=>{(async()=>{try{const i=`http://dev-rare.srp.ai/property/api/advancesearch?customerid=${u==null?void 0:u._id}&sort=descending&type=customer&page=0&perPage=all`,t=`http://dev-rare.srp.ai/property/api/advancesearch?owner_representative_id=${u==null?void 0:u._id}&sort=descending&type=customer&page=0&perPage=all`,o=await fetch(i);if(!o.ok&&o.status!==400)throw new Error(`API 1 failed with status: ${o.status}`);const m=o.status===400?[]:await o.json(),c=await fetch(t);if(!c.ok&&c.status!==400)throw new Error(`API 2 failed with status: ${c.status}`);const b=c.status===400?[]:await c.json(),x=[...m,...b].map(N=>N._id),g=(await Promise.all(x.map(async N=>await(await fetch(`http://dev-rare.srp.ai/booking/ownerrepresentative/pages?propertyid=${N}&page=0&perPage=all`)).json()))).flat([2]),y=ae(g);S(y)}catch(i){console.error("Error fetching data:",i),setLoadingData(!1)}})()},[]),n.exports.useEffect(()=>{(async()=>{const i=p.map(async o=>{const{propertyid:m}=o;return await(await fetch(`http://dev-rare.srp.ai/property/${m}`)).json()}),t=await Promise.all(i);ee(t)})()},[p]),n.exports.useEffect(()=>{if(I(!0),E.length){const e=[...new Map(E.map(t=>[t._id,t])).values()],i=e==null?void 0:e.map(t=>({label:t.unitnumber+" | "+t.communityname+" | "+t.projectname+" | "+t.buildingname,value:t._id}));I(!1),W(i)}},[E]),n.exports.useState(!1);const H=async()=>{_(""),A([]),P({propertyid:""}),Z({startDate:null,endDate:null})};n.exports.useEffect(()=>{var i;let e=0;for(let t=0;t<(r==null?void 0:r.length);t++){let o=parseInt((i=r[t])==null?void 0:i.nonight);e+=o}J(e)},[r==null?void 0:r.length]),n.exports.useEffect(()=>{let e=r.map(i=>Number(i.roomrenthostpayable)).reduce((i,t)=>i+t,0);K(e)},[r==null?void 0:r.length]),n.exports.useRef(null);const le=e=>{const{contractstartdate:i,contractenddate:t}=e;let o=new Date(i),m=new Date(t);return(m.getFullYear()-o.getFullYear())*12+(m.getMonth()-o.getMonth())+" Months"},te=[{Header:"Sr no",accessor:"id",Cell:({row:e,flatRows:i})=>a("span",{children:i.indexOf(e)+1},void 0,!1,{fileName:l,lineNumber:399,columnNumber:24},void 0)},{Header:"guest name",accessor:"guestname",Cell:e=>{var i,t,o,m,c;return a("span",{children:(i=e==null?void 0:e.cell)!=null&&i.value?((o=(t=e==null?void 0:e.cell)==null?void 0:t.value)==null?void 0:o.slice(0,15))+(((c=(m=e==null?void 0:e.cell)==null?void 0:m.value)==null?void 0:c.length)>15?"...":""):"Not Available"},void 0,!1,{fileName:l,lineNumber:406,columnNumber:24},void 0)}},{Header:"reservation date",accessor:"reservationdate",Cell:e=>{var i,t;return a("span",{children:(i=e==null?void 0:e.cell)!=null&&i.value?new Date((t=e==null?void 0:e.cell)==null?void 0:t.value).toDateString():"Not Available"},void 0,!1,{fileName:l,lineNumber:413,columnNumber:24},void 0)}},{Header:"Booking Ref#",accessor:"confirmationcode",Cell:e=>{var i,t,o,m;return a("div",{children:a("span",{className:"inline-flex items-center",children:a("span",{className:"text-sm text-slate-600 dark:text-slate-300 lowercase",children:(i=e==null?void 0:e.cell)!=null&&i.value?((t=e==null?void 0:e.cell)==null?void 0:t.value.slice(0,15))+(((m=(o=e==null?void 0:e.cell)==null?void 0:o.value)==null?void 0:m.length)>15?"...":""):"Not Available"},void 0,!1,{fileName:l,lineNumber:423,columnNumber:29},void 0)},void 0,!1,{fileName:l,lineNumber:422,columnNumber:25},void 0)},void 0,!1,{fileName:l,lineNumber:421,columnNumber:21},void 0)}},{Header:"checkin date",accessor:"checkindate",Cell:e=>{var i,t;return a("span",{children:(i=e==null?void 0:e.cell)!=null&&i.value?new Date((t=e==null?void 0:e.cell)==null?void 0:t.value).toDateString():"Not Available"},void 0,!1,{fileName:l,lineNumber:435,columnNumber:24},void 0)}},{Header:"checkout date",accessor:"checkoutdate",Cell:e=>{var i,t;return a("span",{children:(i=e==null?void 0:e.cell)!=null&&i.value?new Date((t=e==null?void 0:e.cell)==null?void 0:t.value).toDateString():"Not Available"},void 0,!1,{fileName:l,lineNumber:442,columnNumber:24},void 0)}},{id:"no nights stayed",Header:"no nights stayed",accessor:"nonight",Cell:e=>{var i,t;return a("span",{children:(i=e==null?void 0:e.cell)!=null&&i.value?(t=e==null?void 0:e.cell)==null?void 0:t.value:"Not Available"},void 0,!1,{fileName:l,lineNumber:450,columnNumber:24},void 0)}},{Header:"RATE PER DAY",accessor:"tourismfee",Cell:e=>{var m,c,b,T,x,j,g,y,N,R,F,V;let i=(b=(c=(m=e==null?void 0:e.cell)==null?void 0:m.row)==null?void 0:c.original)!=null&&b.nonight?parseFloat((j=(x=(T=e==null?void 0:e.cell)==null?void 0:T.row)==null?void 0:x.original)==null?void 0:j.nonight):0,o=((N=(y=(g=e==null?void 0:e.cell)==null?void 0:g.row)==null?void 0:y.original)!=null&&N.roomrenthostpayable?parseFloat((V=(F=(R=e==null?void 0:e.cell)==null?void 0:R.row)==null?void 0:F.original)==null?void 0:V.roomrenthostpayable):0)/i;return a("span",{children:o?parseFloat(o).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})+" AED":"0.00"},void 0,!1,{fileName:l,lineNumber:462,columnNumber:21},void 0)}},{Header:"BOOKING AMOUNT",accessor:"roomrenthostpayable",Cell:e=>{var i,t;return a("span",{children:(i=e==null?void 0:e.cell)!=null&&i.value?parseFloat((t=e==null?void 0:e.cell)==null?void 0:t.value).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})+" AED":"0.00"},void 0,!1,{fileName:l,lineNumber:471,columnNumber:21},void 0)}}],ie=n.exports.useMemo(()=>te,[]),re=n.exports.useMemo(()=>r);return f.exports.useTable({columns:ie,data:re,initialState:{pageIndex:0,pageSize:50}},f.exports.useGlobalFilter,f.exports.useSortBy,f.exports.usePagination,f.exports.useRowSelect,e=>{e.visibleColumns.push(i=>[{id:"selection",Header:({getToggleAllRowsSelectedProps:t})=>a("div",{children:a(q,{...t()},void 0,!1,{fileName:l,lineNumber:513,columnNumber:29},void 0)},void 0,!1,{fileName:l,lineNumber:512,columnNumber:25},void 0),Cell:({row:t})=>a("div",{children:a(q,{...t.getToggleRowSelectedProps()},void 0,!1,{fileName:l,lineNumber:518,columnNumber:29},void 0)},void 0,!1,{fileName:l,lineNumber:517,columnNumber:25},void 0)},...i])}),console.log("==========>",r),a(d,{children:a("div",{className:"xl:col-span-2 col-span-1",children:a(ne,{title:"Tenancy Summary Report",children:[a("div",{className:"flex flex-row-reverse"},void 0,!1,{fileName:l,lineNumber:552,columnNumber:21},void 0),a("div",{children:[a("form",{className:"lg:grid-cols-3 grid gap-5 grid-cols-1 ",children:[C===!0?null:a(d,{children:a("div",{className:"w-[100%] col-span-3",children:a("h4",{className:"text-base text-slate-800 dark:text-slate-300 mb-[0.5rem] mt-[0.5rem]",children:"Select Property"},void 0,!1,{fileName:l,lineNumber:565,columnNumber:33},void 0)},void 0,!1,{fileName:l,lineNumber:564,columnNumber:29},void 0)},void 0,!1),a("div",{className:"w-[100%] col-span-3",children:C===!0?a(d,{children:a("div",{className:"flex items-center justify-center h-[100%]",children:a("img",{src:Y,width:150,height:150},void 0,!1,{fileName:l,lineNumber:580,columnNumber:50},void 0)},void 0,!1,{fileName:l,lineNumber:579,columnNumber:42},void 0)},void 0,!1):a(d,{children:a(oe,{label:"Basic Select",className:"react-select",classNamePrefix:"select",options:h,value:h&&k?h.filter(function(e){return e.value===(s==null?void 0:s.propertyid)}):h.filter(function(e){return e.value===(s==null?void 0:s.propertyid)}),placeholder:"Select and Search Property",onChange:e=>{k?H():P({propertyid:e==null?void 0:e.value,propertyname:e==null?void 0:e.label},"select box")},styles:ce,id:"hh"},void 0,!1,{fileName:l,lineNumber:585,columnNumber:45},void 0)},void 0,!1)},void 0,!1,{fileName:l,lineNumber:572,columnNumber:29},void 0)]},void 0,!0,{fileName:l,lineNumber:556,columnNumber:25},void 0),"  ",(s==null?void 0:s.propertyid)&&a(d,{children:a("div",{className:"flex justify-end mt-[25px]",children:[a("div",{className:"w-[150px]",children:a("div",{className:"date-range-custom relative",children:a(me,{value:X,inputClassName:"input-class",containerClassName:"container-class",onChange:w},void 0,!1,{fileName:l,lineNumber:620,columnNumber:49},void 0)},void 0,!1,{fileName:l,lineNumber:619,columnNumber:45},void 0)},void 0,!1,{fileName:l,lineNumber:618,columnNumber:41},void 0),k&&a(d,{children:a("div",{className:"flex justify-end",children:a("div",{className:"w-[90px]",children:a("div",{className:"date-range-custom relative",children:a("button",{className:"btn btn-dark text-white  text-center",onClick:H,children:"Reset"},void 0,!1,{fileName:l,lineNumber:634,columnNumber:65},void 0)},void 0,!1,{fileName:l,lineNumber:633,columnNumber:61},void 0)},void 0,!1,{fileName:l,lineNumber:632,columnNumber:57},void 0)},void 0,!1,{fileName:l,lineNumber:631,columnNumber:53},void 0)},void 0,!1)]},void 0,!0,{fileName:l,lineNumber:617,columnNumber:37},void 0)},void 0,!1)]},void 0,!0,{fileName:l,lineNumber:555,columnNumber:21},void 0),Q===!0?a(d,{children:a("div",{className:"flex items-center justify-center h-[100%]",children:a("img",{src:Y,width:150,height:150},void 0,!1,{fileName:l,lineNumber:677,columnNumber:37},void 0)},void 0,!1,{fileName:l,lineNumber:676,columnNumber:33},void 0)},void 0,!1):r&&r.length?a(d,{children:a("div",{className:"overflow-x-auto -mx-6",children:a("div",{className:"inline-block min-w-full align-middle",children:a("div",{className:"overflow-hidden p-[20px] ",children:[a("div",{className:"w-[100%] col-span-3",children:[a("div",{className:"w-[100%] col-span-3 mb-4",children:a("div",{className:"borderBottom"},void 0,!1,{fileName:l,lineNumber:689,columnNumber:69},void 0)},void 0,!1,{fileName:l,lineNumber:688,columnNumber:65},void 0),a("h4",{className:"text-lg font-semibold text-slate-800 dark:text-slate-300 mb-[0.5rem] mt-[0.5rem]",children:"CONTRACT DETAILS"},void 0,!1,{fileName:l,lineNumber:691,columnNumber:65},void 0)]},void 0,!0,{fileName:l,lineNumber:687,columnNumber:37},void 0),a("div",{className:"mt-[25px] flex justify-between",children:a("div",{children:[a("div",{className:"flex gap-x-[10px]",children:[a("p",{className:"font-semibold",children:"Landlord Name: "},void 0,!1,{fileName:l,lineNumber:699,columnNumber:73},void 0),a("p",{className:"capitalize",children:r?(O=r[0])==null?void 0:O.propertyid.ownernamedeed:"Not Avaiable"},void 0,!1,{fileName:l,lineNumber:700,columnNumber:73},void 0)]},void 0,!0,{fileName:l,lineNumber:698,columnNumber:69},void 0),a("div",{className:"flex gap-x-[10px]",children:[a("p",{className:"font-semibold",children:"Community Name: "},void 0,!1,{fileName:l,lineNumber:703,columnNumber:73},void 0),a("p",{className:"capitalize",children:r?(M=r[0])==null?void 0:M.propertyid.communityname:"Not Avaiable"},void 0,!1,{fileName:l,lineNumber:704,columnNumber:73},void 0)]},void 0,!0,{fileName:l,lineNumber:702,columnNumber:69},void 0),a("div",{className:"flex gap-x-[10px]",children:[a("p",{className:"font-semibold",children:"Project Name: "},void 0,!1,{fileName:l,lineNumber:707,columnNumber:73},void 0),a("p",{className:"capitalize",children:r?(z=r[0])==null?void 0:z.propertyid.projectname:"Not Avaiable"},void 0,!1,{fileName:l,lineNumber:708,columnNumber:73},void 0)]},void 0,!0,{fileName:l,lineNumber:706,columnNumber:69},void 0),a("div",{className:"flex gap-x-[10px]",children:[a("p",{className:"font-semibold",children:"Apartment No: "},void 0,!1,{fileName:l,lineNumber:711,columnNumber:73},void 0),a("p",{className:"capitalize",children:r?(U=r[0])==null?void 0:U.propertyid.unitnumber:"Not Avaiable"},void 0,!1,{fileName:l,lineNumber:712,columnNumber:73},void 0)]},void 0,!0,{fileName:l,lineNumber:710,columnNumber:69},void 0),a("div",{className:"flex gap-x-[10px]",children:[a("p",{className:"font-semibold",children:"Building No: "},void 0,!1,{fileName:l,lineNumber:715,columnNumber:73},void 0),a("p",{className:"capitalize",children:r?(B=r[0])==null?void 0:B.propertyid.buildingname:"Not Avaiable"},void 0,!1,{fileName:l,lineNumber:716,columnNumber:73},void 0)]},void 0,!0,{fileName:l,lineNumber:714,columnNumber:69},void 0)]},void 0,!0,{fileName:l,lineNumber:697,columnNumber:65},void 0)},void 0,!1,{fileName:l,lineNumber:696,columnNumber:61},void 0),a("div",{className:"overflow-x-auto -mx-6 mt-6",children:a("div",{className:"p-[20px]",children:a(se,{responsive:"lg",bordered:!0,className:"w-[1280px]",children:[a("thead",{className:"border bg-black-200 text-black",children:a("tr",{className:"w-[150px] h-[60px]",children:[a("th",{className:"text-center border-r border-gray-500 text-[14px]",children:"Sr no"},void 0,!1,{fileName:l,lineNumber:727,columnNumber:81},void 0),a("th",{className:"text-center border-r border-gray-500 text-[14px]",children:"Tenancy contract No:"},void 0,!1,{fileName:l,lineNumber:728,columnNumber:81},void 0),a("th",{className:"text-center border-r border-gray-500 text-[14px] w-[120px]",children:"Status"},void 0,!1,{fileName:l,lineNumber:729,columnNumber:81},void 0),a("th",{className:"text-center border-r border-gray-500 text-[14px]",children:"Tenancy Start Date:"},void 0,!1,{fileName:l,lineNumber:730,columnNumber:81},void 0),a("th",{className:"text-center border-r border-gray-500 text-[14px]",children:"Tenancy Expiry Date"},void 0,!1,{fileName:l,lineNumber:731,columnNumber:81},void 0),a("th",{className:"text-center border-r border-gray-500 text-[14px]",children:"Tenancy Period:"},void 0,!1,{fileName:l,lineNumber:732,columnNumber:81},void 0),a("th",{className:"text-center border-r border-gray-500 text-[14px]",children:"Rental Amount"},void 0,!1,{fileName:l,lineNumber:733,columnNumber:81},void 0)]},void 0,!0,{fileName:l,lineNumber:726,columnNumber:77},void 0)},void 0,!1,{fileName:l,lineNumber:725,columnNumber:73},void 0),a("tbody",{children:[s.propertyid&&r&&r.length>0&&r.map((e,i)=>a(d,{children:a("tr",{children:[a("td",{className:"border border-gray-100 text-center",children:i+1},void 0,!1,{fileName:l,lineNumber:745,columnNumber:101},void 0),a("td",{className:"border border-gray-100 text-center",children:e.tenantcontractno?e.tenantcontractno:"Not Available"},void 0,!1,{fileName:l,lineNumber:746,columnNumber:105},void 0),a("td",{className:` inline-block px-3 min-w-[90px] text-center mx-auto py-1 rounded-[999px] bg-opacity-25 ${new Date(e.contractenddate)>new Date?"text-success-500 bg-success-500":"text-danger-500 bg-danger-500"} `,children:new Date(e.contractenddate)>new Date?"Active":"Expired"},void 0,!1,{fileName:l,lineNumber:747,columnNumber:105},void 0),a("td",{className:"border border-gray-100 text-center",children:e.contractstartdate?new Date(e.contractstartdate).toDateString():"Not Available"},void 0,!1,{fileName:l,lineNumber:755,columnNumber:105},void 0),a("td",{className:"border border-gray-100 text-center",children:e.contractenddate?new Date(e.contractenddate).toDateString():"Not Available"},void 0,!1,{fileName:l,lineNumber:756,columnNumber:105},void 0),a("td",{className:"border border-gray-100 text-center",children:e?le(e):"Not Available"},void 0,!1,{fileName:l,lineNumber:757,columnNumber:105},void 0),a("td",{className:"border border-gray-100 text-center",children:["AED ",e.rentalamount?e.rentalamount:"Not Available"]},void 0,!0,{fileName:l,lineNumber:758,columnNumber:105},void 0)]},void 0,!0,{fileName:l,lineNumber:743,columnNumber:97},void 0)},void 0,!1)),a("tr",{children:[a("td",{colSpan:"6",className:"border border-gray-300 text-center"},void 0,!1,{fileName:l,lineNumber:769,columnNumber:73},void 0),a("td",{className:"border border-gray-300 text-center",children:["AED ",r.map(e=>Number(e.rentalamount)).reduce((e,i)=>e+i,0)]},void 0,!0,{fileName:l,lineNumber:771,columnNumber:73},void 0)]},void 0,!0,{fileName:l,lineNumber:768,columnNumber:73},void 0)]},void 0,!0,{fileName:l,lineNumber:736,columnNumber:89},void 0)]},void 0,!0,{fileName:l,lineNumber:724,columnNumber:69},void 0)},void 0,!1,{fileName:l,lineNumber:723,columnNumber:65},void 0)},void 0,!1,{fileName:l,lineNumber:722,columnNumber:61},void 0)]},void 0,!0,{fileName:l,lineNumber:686,columnNumber:37},void 0)},void 0,!1,{fileName:l,lineNumber:685,columnNumber:33},void 0)},void 0,!1,{fileName:l,lineNumber:684,columnNumber:29},void 0)},void 0,!1):a(d,{children:C===!0?null:a(d,{children:a("div",{className:"pl-6",children:a("h6",{className:" text-base text-slate-800 dark:text-slate-300 mb-[0.5rem] mt-[0.5rem]",children:"No Property Data Found"},void 0,!1,{fileName:l,lineNumber:792,columnNumber:33},void 0)},void 0,!1,{fileName:l,lineNumber:791,columnNumber:33},void 0)},void 0,!1)},void 0,!1)]},void 0,!0,{fileName:l,lineNumber:551,columnNumber:17},void 0)},void 0,!1,{fileName:l,lineNumber:550,columnNumber:13},void 0)},void 0,!1)};export{ge as default};
