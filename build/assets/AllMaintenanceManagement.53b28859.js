import{r as C,ag as E,j as t,F as u,C as F,c as _,L as q,bN as D}from"./index.9c545f0d.js";import{I as L,M as Q}from"./InvoicesTable.15bd1d87.js";import"./GlobalFilter.4b7aa83d.js";const U=()=>{const[i,w]=C.exports.useState([]),[N,o]=C.exports.useState(!1),j=localStorage.getItem("isAuth"),a=JSON.parse(j),h=E();C.exports.useEffect(()=>{o(!0),(async()=>{o(!0);try{const c=`http://dev-rare.srp.ai/property/api/advancesearch?customerid=${a==null?void 0:a._id}&sort=descending&type=customer&page=0&perPage=all`,M=`http://dev-rare.srp.ai/property/api/advancesearch?owner_representative_id=${a==null?void 0:a._id}&sort=descending&type=customer&page=0&perPage=all`,n=await fetch(c);if(!n.ok&&n.status!==400)throw new Error(`API 1 failed with status: ${n.status}`);const v=n.status===400?[]:await n.json(),s=await fetch(M);if(!s.ok&&s.status!==400)throw new Error(`API 2 failed with status: ${s.status}`);const y=s.status===400?[]:await s.json(),g=[...v,...y];if(h.pathname==="/owner-maintenancemanagement-invoices"){const d=g.map(e=>e._id).map(e=>fetch(`http://dev-rare.srp.ai/maintenancemanagement/api/q?propertyid=${e}&converted_invoice=true`).then(f=>f.json())),l=(await Promise.all(d)).filter(e=>e.message!=="No Maintenance Management found"),p=[].concat(...l),r=new Map;p.forEach(e=>{r.has(e==null?void 0:e._id)||r.set(e==null?void 0:e._id,e)});const m=[...Array.from(r.values())].reverse();w(m),o(!1)}else{const d=g.map(e=>e._id).map(e=>fetch(`http://dev-rare.srp.ai/maintenancemanagement/api/q?propertyid=${e}`).then(f=>f.json())),l=(await Promise.all(d)).filter(e=>e.message!=="No Maintenance Management found"),p=[].concat(...l),r=new Map;p.forEach(e=>{r.has(e==null?void 0:e._id)||r.set(e==null?void 0:e._id,e)});const m=[...Array.from(r.values())].reverse();w(m),o(!1)}}catch(c){console.error("Error fetching data:",c),o(!1)}})()},[h.pathname]);const x=()=>{o(!0),(async()=>{o(!0);try{const c=`http://dev-rare.srp.ai/property/api/advancesearch?customerid=${a==null?void 0:a._id}&sort=descending&type=customer&page=0&perPage=all`,M=`http://dev-rare.srp.ai/property/api/advancesearch?owner_representative_id=${a==null?void 0:a._id}&sort=descending&type=customer&page=0&perPage=all`,n=await fetch(c);if(!n.ok&&n.status!==400)throw new Error(`API 1 failed with status: ${n.status}`);const v=n.status===400?[]:await n.json(),s=await fetch(M);if(!s.ok&&s.status!==400)throw new Error(`API 2 failed with status: ${s.status}`);const y=s.status===400?[]:await s.json(),d=[...v,...y].map(e=>e._id).map(e=>fetch(`http://dev-rare.srp.ai/maintenancemanagement/api/q?propertyid=${e}`).then(f=>f.json())),l=(await Promise.all(d)).filter(e=>e.message!=="No Maintenance Management found"),p=[].concat(...l),r=new Map;p.forEach(e=>{r.has(e==null?void 0:e._id)||r.set(e==null?void 0:e._id,e)});const m=[...Array.from(r.values())].reverse();w(m),o(!1)}catch(c){console.error("Error fetching data:",c),o(!1)}})()};return t(u,{children:N===!1?t(u,{children:i!=null&&i.length?t("div",{className:" space-y-5",children:h.pathname==="/owner-maintenancemanagement-invoices"?t(L,{title:"All Maintenance Management Invoices",allData:i}):t(Q,{pagelink:"/maintenancemanagementform",linktitle:"Create Maintenance Management Quotations",title:"All Maintenance Management Quotations",allData:i,updateData:x})}):t(F,{children:h.pathname==="/owner-maintenancemanagement-invoices"?_(u,{children:[t("div",{className:"flex justify-between items-center mb-6",children:t("h4",{className:"card-title",children:"All Maintenance Management Invoices"})}),t("p",{children:"No Maintenance Management Invoices Found"})]}):_(u,{children:[_("div",{className:"flex justify-between items-center mb-6",children:[t("h4",{className:"card-title",children:"All Maintenance Management Quotations"}),t(q,{to:"/maintenancemanagementform",className:"btn-dark py-[8px] px-[24px] rounded-[5px]",children:"Add Maintenance Management Quotations"})]}),t("p",{children:"No Maintenance Management Quotations Found"})]})})}):t(D,{})})};export{U as default};
