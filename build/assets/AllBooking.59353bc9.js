import{R as G,j as l,F as X,r as m,b as E,c as o,f as V,G as re,I as $,aq as O,cb as de,cc as me,E as ue,bO as pe}from"./index.1ecd67a9.js";import{G as he}from"./GlobalFilter.fa3e5389.js";import"./index.esm.5ffb8825.js";const W=G.forwardRef(({indeterminate:h,...v},H)=>{const n=G.useRef(),g=H||n;return G.useEffect(()=>{g.current.indeterminate=h},[g,h]),l(X,{children:l("input",{type:"checkbox",ref:g,...v,className:"table-checkbox"})})}),U={option:(h,v)=>({...h,fontSize:"14px"})},ge=({title:h,linktitle:v,pagelink:H,allData:n,forFilterData:g,handleFilterSearch:I,handleClearFilter:x})=>{const[a,f]=m.exports.useState(""),[c,T]=m.exports.useState(!1),A=e=>{const{name:t,value:s}=e.target;f({...a,[t]:s})},L=[{Header:"Sr no",accessor:"id",Cell:({row:e,flatRows:t})=>l("span",{children:t.indexOf(e)+1})},{Header:"Booking Status",accessor:"cancelled",Cell:e=>{var t,s,i;return l("span",{className:"block w-full",children:l("span",{className:` inline-block px-3 min-w-[90px] text-center mx-auto py-1 rounded-[999px] bg-opacity-25 ${((t=e==null?void 0:e.cell)==null?void 0:t.value)===!1?"text-success-500 bg-success-500":""} 
            ${((s=e==null?void 0:e.cell)==null?void 0:s.value)===!0?"text-danger-500 bg-danger-500":""}
            
             `,children:((i=e==null?void 0:e.cell)==null?void 0:i.value)===!0?"Cancelled":"Approved"})})}},{Header:"booking number",accessor:"bookingnumber",Cell:e=>{var t,s,i;return l("span",{children:(t=e==null?void 0:e.cell)!=null&&t.value?((s=e==null?void 0:e.cell)==null?void 0:s.value.slice(0,15))+(((i=e==null?void 0:e.cell)==null?void 0:i.value.length)>15?"...":""):"Not Available"})}},{Header:"confirmation code",accessor:"confirmationcode",Cell:e=>{var t,s,i,r;return l("div",{children:l("span",{className:"inline-flex items-center",children:l("span",{className:"text-sm text-slate-600 dark:text-slate-300 lowercase",children:(t=e==null?void 0:e.cell)!=null&&t.value?((s=e==null?void 0:e.cell)==null?void 0:s.value.slice(0,15))+(((r=(i=e==null?void 0:e.cell)==null?void 0:i.value)==null?void 0:r.length)>15?"...":""):"Not Available"})})})}},{Header:"guest name",accessor:"guestname",Cell:e=>{var t,s,i,r,b;return l("span",{children:(t=e==null?void 0:e.cell)!=null&&t.value?((i=(s=e==null?void 0:e.cell)==null?void 0:s.value)==null?void 0:i.slice(0,15))+(((b=(r=e==null?void 0:e.cell)==null?void 0:r.value)==null?void 0:b.length)>15?"...":""):"Not Available"})}},{Header:"unit number",accessor:"unitnumber",Cell:e=>{var t,s,i,r,b;return l("span",{children:(t=e==null?void 0:e.cell)!=null&&t.value?((i=(s=e==null?void 0:e.cell)==null?void 0:s.value)==null?void 0:i.slice(0,15))+(((b=(r=e==null?void 0:e.cell)==null?void 0:r.value)==null?void 0:b.length)>15?"...":""):"Not Available"})}},{Header:"booking agent",accessor:"bookingagent",Cell:e=>{var t,s,i,r,b;return l("span",{children:(t=e==null?void 0:e.cell)!=null&&t.value?((i=(s=e==null?void 0:e.cell)==null?void 0:s.value)==null?void 0:i.slice(0,15))+(((b=(r=e==null?void 0:e.cell)==null?void 0:r.value)==null?void 0:b.length)>15?"...":""):"Not Available"})}},{Header:"Check in Date",accessor:"checkindate",Cell:e=>{var t,s;return l("span",{children:(t=e==null?void 0:e.cell)!=null&&t.value?(s=e==null?void 0:e.cell)==null?void 0:s.value.split("T")[0]:"Not Available"})},sortType:(e,t,s,i)=>de(e,t,s,i)},{Header:"Check out Date",accessor:"checkoutdate",Cell:e=>{var t,s;return l("span",{children:(t=e==null?void 0:e.cell)!=null&&t.value?(s=e==null?void 0:e.cell)==null?void 0:s.value.split("T")[0]:"Not Available"})},sortType:(e,t,s,i)=>me(e,t,s,i)},{Header:"Room Rent Amount: (host Payable)",accessor:"roomrenthostpayable",Cell:e=>{var t,s;return l("span",{children:(t=e==null?void 0:e.cell)!=null&&t.value?parseFloat((s=e==null?void 0:e.cell)==null?void 0:s.value).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})+" AED":"0.00"})}},{Header:"Host Management Fee",accessor:"hostmanagementfee",Cell:e=>{var t,s;return l("span",{children:(t=e==null?void 0:e.cell)!=null&&t.value?((s=e==null?void 0:e.cell)==null?void 0:s.value.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))+" AED":"0.00"})}},{Header:"created-on",accessor:"createdAt",Cell:e=>{var t,s;return l("span",{children:(t=e==null?void 0:e.cell)!=null&&t.value?new Date((s=e==null?void 0:e.cell)==null?void 0:s.value).toDateString():"Not Available"})}}],p=m.exports.useMemo(()=>L,[]),k=m.exports.useMemo(()=>n),N=E.exports.useTable({columns:p,data:k,initialState:{pageIndex:0,pageSize:50}},E.exports.useGlobalFilter,E.exports.useSortBy,E.exports.usePagination,E.exports.useRowSelect,e=>{e.visibleColumns.push(t=>[{id:"selection",Header:({getToggleAllRowsSelectedProps:s})=>l("div",{children:l(W,{...s()})}),Cell:({row:s})=>l("div",{children:l(W,{...s.getToggleRowSelectedProps()})})},...t])}),{getTableProps:u,getTableBodyProps:R,headerGroups:y,footerGroups:_,page:q,nextPage:M,previousPage:j,canNextPage:B,canPreviousPage:C,pageOptions:S,state:P,gotoPage:d,pageCount:F,setPageSize:Z,setGlobalFilter:D,prepareRow:w}=N,{globalFilter:ee,pageIndex:z,pageSize:te}=P,[Y,le]=m.exports.useState(0);m.exports.useEffect(()=>{var e,t;if(n!=null&&n.length){let s=0;for(let i=0;i<(n==null?void 0:n.length);i++){let r=parseFloat((e=n[i])==null?void 0:e.roomrentamount);!isNaN(r)&&((t=n[i])==null?void 0:t.cancelled)===!1&&(s+=r)}le(s||0)}},[n==null?void 0:n.length]);const[se,ae]=m.exports.useState(0);m.exports.useEffect(()=>{if(n!=null&&n.length){let e=n==null?void 0:n.filter(t=>t.cancelled===!1).length;ae(e)}},[n]);const ne=[{name:{series:[{data:[800,600,1e3,800,600,1e3,800,900]}],options:{chart:{toolbar:{autoSelected:"pan",show:!1},offsetX:0,offsetY:0,zoom:{enabled:!1},sparkline:{enabled:!0}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:2},colors:["#00EBFF"],tooltip:{theme:"light"},grid:{show:!1,padding:{left:0,right:0}},yaxis:{show:!1},fill:{type:"solid",opacity:[.1]},legend:{show:!1},xaxis:{low:0,offsetX:0,offsetY:0,show:!1,labels:{low:0,offsetX:0,show:!1},axisBorder:{low:0,offsetX:0,show:!1}}}},title:"Total No of Check-In",count:se,bg:"bg-[#E5F9FF] dark:bg-slate-900	"},{name:{series:[{data:[800,600,1e3,800,600,1e3,800,900]}],options:{chart:{toolbar:{autoSelected:"pan",show:!1},offsetX:0,offsetY:0,zoom:{enabled:!1},sparkline:{enabled:!0}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:2},colors:["#FB8F65"],tooltip:{theme:"light"},grid:{show:!1,padding:{left:0,right:0}},yaxis:{show:!1},fill:{type:"solid",opacity:[.1]},legend:{show:!1},xaxis:{low:0,offsetX:0,offsetY:0,show:!1,labels:{low:0,offsetX:0,show:!1},axisBorder:{low:0,offsetX:0,show:!1}}}},title:"Total Collection",count:Y?Y.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})+" AED":0,bg:"bg-[#FFEDE5] dark:bg-slate-900	"}],ie=g.filter(e=>e.unitnumber!==void 0),J=[...new Set(ie.map(e=>e.unitnumber))].sort((e,t)=>e.localeCompare(t,void 0,{sensitivity:"base"})).map(e=>({label:e,value:e})),ce=g.filter(e=>e.email!==void 0),K=[...[...new Set(ce.map(e=>e.email))].map(e=>{const t=g.find(s=>s.email===e);return t?{label:t.guestname+" | "+t.email,value:t.email}:null}).filter(Boolean)].sort((e,t)=>e.label.localeCompare(t.label)),Q=[...[{value:"Airbnb",label:"Airbnb"},{value:"Booking.com",label:"Booking.com"},{value:"vrbo",label:"vrbo"},{value:"Direct Booking",label:"Direct Booking"},{value:"Not in the List",label:"Not in the List"}]].sort((e,t)=>e.label.localeCompare(t.label)),oe=()=>{x(),f("")};return l(X,{children:o(V,{children:[l("div",{className:"grid grid-cols-12 gap-5 mb-5",children:l("div",{className:"2xl:col-span-12 lg:col-span-12 col-span-12",children:l(V,{bodyClass:"p-4",children:l("div",{className:"grid md:grid-cols-2 col-span-1 gap-4",children:l(re,{statistics:ne})})})})}),o("div",{className:"flex justify-between items-center mb-6",children:[l("h4",{className:"card-title",children:h}),o("div",{className:"md:flex justify-end items-center mb-6 gap-x-[25px]",children:[o("button",{className:"h-[34px] rounded-[10px] relative bg-white border1px flex items-center gap-x-[10px] justify-around px-[10px] py-[5px] cursor-pointer md:mb-0 mb-4",onClick:()=>T(!c),children:[c===!0?l($,{icon:"heroicons:minus-small",className:"w-[20px] h-[20px]"}):l($,{icon:"heroicons:plus-small",className:"w-[20px] h-[20px]"}),l("p",{className:"text-[16px] leading regular color-black",children:"Advance filter"})]}),l(he,{filter:ee,setFilter:D})]})]}),o("div",{className:`xl:grid-cols-3 grid gap-5 grid-cols-1 ${c===!0?"filter-show mt-6 pointer-events-auto":"filter-remove -mt-4 pointer-events-none"}`,children:[o("div",{children:[l("label",{htmlFor:" hh",className:"form-label ",children:"Unit No."}),l(O,{label:"Basic Select",className:"react-select",classNamePrefix:"select",options:J,value:J.filter(function(e){if((a==null?void 0:a.unitnumber)!=="")return e.value===(a==null?void 0:a.unitnumber)}),onChange:e=>{A({target:{name:"unitnumber",value:e.value}})},styles:U,id:"hh",placeholder:"Select..."}),a!=null&&a.unitnumber?l("div",{className:" mt-2 block text-sm cursor-pointer",onClick:()=>f({...a,unitnumber:""}),children:"Clear filter"}):null]}),o("div",{children:[l("label",{htmlFor:" hh",className:"form-label ",children:"Guest Name / Email"}),l(O,{label:"Basic Select",className:"react-select",classNamePrefix:"select",options:K,value:K.filter(function(e){if((a==null?void 0:a.email)!=="")return e.value===(a==null?void 0:a.email)}),onChange:e=>{A({target:{name:"email",value:e.value}})},styles:U,id:"hh",placeholder:"Select..."}),a!=null&&a.email?l("div",{className:" mt-2 block text-sm cursor-pointer",onClick:()=>f({...a,email:""}),children:"Clear filter"}):null]}),o("div",{children:[l("label",{htmlFor:" hh",className:"form-label ",children:"Booking Agent"}),l(O,{label:"Basic Select",className:"react-select",classNamePrefix:"select",options:Q,value:Q.filter(function(e){if((a==null?void 0:a.bookingagent)!=="")return e.value===(a==null?void 0:a.bookingagent)}),onChange:e=>{A({target:{name:"bookingagent",value:e.value}})},styles:U,id:"hh",placeholder:"Select..."}),a!=null&&a.bookingagent?l("div",{className:" mt-2 block text-sm cursor-pointer",onClick:()=>f({...a,bookingagent:""}),children:"Clear filter"}):null]})]}),o("div",{className:`flex ${c===!0?"filter-show mt-6 pointer-events-auto":"filter-remove mt-0 pointer-events-none"} justify-end gap-x-[10px]`,children:[l("button",{className:"btn btn-secondary  text-center",type:"button",onClick:()=>oe(),children:"Clear filter"}),l("button",{className:"btn btn-dark  text-center",type:"button",onClick:()=>I(a),children:"Search"})]}),l("div",{className:"overflow-x-auto -mx-6 mt-6",children:l("div",{className:"inline-block min-w-full align-middle",children:l("div",{className:"overflow-hidden ",children:o("table",{className:"min-w-full divide-y divide-slate-100 table-fixed dark:divide-slate-700",...u,children:[l("thead",{className:"bg-slate-200 dark:bg-slate-700",children:y.map(e=>l("tr",{...e.getHeaderGroupProps(),children:e.headers.map(t=>o("th",{...t.getHeaderProps(t.getSortByToggleProps()),scope:"col",className:" table-th ",children:[t.render("Header"),l("span",{children:t.isSorted?t.isSortedDesc?" \u{1F53D}":" \u{1F53C}":""})]}))}))}),l("tbody",{className:"bg-white divide-y divide-slate-100 dark:bg-slate-800 dark:divide-slate-700",...R,children:q.map(e=>(w(e),l("tr",{...e.getRowProps(),children:e.cells.map(t=>l("td",{...t.getCellProps(),className:"table-td",children:t.render("Cell")}))})))})]})})})}),o("div",{className:"md:flex md:space-y-0 space-y-5 justify-between mt-6 items-center",children:[o("div",{className:" flex items-center space-x-3 rtl:space-x-reverse",children:[l("select",{className:"form-control py-2 w-max",value:te,onChange:e=>Z(Number(e.target.value)),children:[50,100,200].map(e=>o("option",{value:e,children:["Show ",e]},e))}),o("span",{className:"text-sm font-medium text-slate-600 dark:text-slate-300",children:["Page"," ",o("span",{children:[z+1," of ",S.length]})]})]}),o("ul",{className:"flex items-center  space-x-3  rtl:space-x-reverse",children:[l("li",{className:"text-xl leading-4 text-slate-900 dark:text-white rtl:rotate-180",children:l("button",{className:` ${C?"":"opacity-50 cursor-not-allowed"}`,onClick:()=>d(0),disabled:!C,children:l($,{icon:"heroicons:chevron-double-left-solid"})})}),l("li",{className:"text-sm leading-4 text-slate-900 dark:text-white rtl:rotate-180",children:l("button",{className:` ${C?"":"opacity-50 cursor-not-allowed"}`,onClick:()=>j(),disabled:!C,children:"Prev"})}),S.map((e,t)=>l("li",{children:l("button",{href:"#","aria-current":"page",className:` ${t===z?"bg-slate-900 dark:bg-slate-600  dark:text-slate-200 text-white font-medium ":"bg-slate-100 dark:bg-slate-700 dark:text-slate-400 text-slate-900  font-normal  "}    text-sm rounded leading-[16px] flex h-6 w-6 items-center justify-center transition-all duration-150`,onClick:()=>d(t),children:e+1})},t)),l("li",{className:"text-sm leading-4 text-slate-900 dark:text-white rtl:rotate-180",children:l("button",{className:` ${B?"":"opacity-50 cursor-not-allowed"}`,onClick:()=>M(),disabled:!B,children:"Next"})}),l("li",{className:"text-xl leading-4 text-slate-900 dark:text-white rtl:rotate-180",children:l("button",{onClick:()=>d(F-1),disabled:!B,className:` ${B?"":"opacity-50 cursor-not-allowed"}`,children:l($,{icon:"heroicons:chevron-double-right-solid"})})})]})]})]})})},Ae=()=>{const[h,v]=m.exports.useState(!1),[H,n]=m.exports.useState([]),[g,I]=m.exports.useState(""),[x,a]=m.exports.useState(""),f=localStorage.getItem("isAuth"),c=JSON.parse(f);console.log("===========>",f);const T=ue();m.exports.useEffect(()=>{v(!0),c!=null&&c.type?(async()=>{try{const k=`http://portals.rarehomesgroup.com/property/api/advancesearch?customerid=${c==null?void 0:c._id}&sort=descending&type=customer&page=0&perPage=all`,N=`http://portals.rarehomesgroup.com/property/api/advancesearch?owner_representative_id=${c==null?void 0:c._id}&sort=descending&type=customer&page=0&perPage=all`,u=await fetch(k);if(!u.ok&&u.status!==400)throw new Error(`API 1 failed with status: ${u.status}`);const R=u.status===400?[]:await u.json(),y=await fetch(N);if(!y.ok&&y.status!==400)throw new Error(`API 2 failed with status: ${y.status}`);const _=y.status===400?[]:await y.json(),j=[...R,..._].map(d=>d._id).map(d=>fetch(`http://portals.rarehomesgroup.com/booking/ownerrepresentative/pages?propertyid=${d}&ownerid=${c==null?void 0:c._id}&page=0&perPage=10`).then(F=>F.json())),C=(await Promise.all(j)).reduce((d,F)=>d.concat(F),[]),S=new Map;C.forEach(d=>{S.has(d._id)||S.set(d._id,d)});const P=Array.from(S.values());n(P),I(P),a(P)}catch(k){console.error("Error fetching data:",k),v(!1)}})():setTimeout(()=>{T("/access-denied")},1e3),v(!1)},[c==null?void 0:c.type,h]);function A(p){if(p){const k=x.filter(N=>{let u=!0;return p.unitnumber&&N.unitnumber!==p.unitnumber&&(u=!1),p.email&&N.email!==p.email&&(u=!1),p.bookingagent&&N.bookingagent!==p.bookingagent&&(u=!1),u});n(k)}else n(x)}const L=async()=>{n(x)};return l(X,{children:o("div",{className:" space-y-5",children:[h&&!x.length?l(pe,{}):null,x.length>0?l(ge,{pagelink:"/add-property",linktitle:"Add new Property",title:"All Booking",allData:H,forFilterData:g,handleFilterSearch:A,handleClearFilter:L}):"no booking found"]})})};export{Ae as default};
