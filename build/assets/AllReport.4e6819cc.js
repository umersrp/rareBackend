import{R as B,r,j as l,F as f,C as w,am as ee}from"./index.0d75234e.js";import{D as le}from"./index.esm.3c705dd8.js";import"./jspdf.es.min.2b6ef780.js";import"./html2canvas.esm.0eae2bf4.js";import{r as g}from"./index.a246dc5d.js";var a="D:\\Ahsan\\Rare\\Dev\\Rare_Frontend\\src\\pages\\booking-management\\booking-report\\ReportTable.jsx";const ie=B.forwardRef(({allBooking:e,propertyData:n,loadingPropertyforData:z},C)=>{const v=[{Header:"Sr no",accessor:"id",Cell:({row:i,flatRows:m})=>l("span",{children:m.indexOf(i)+1},void 0,!1,{fileName:a,lineNumber:20,columnNumber:24},void 0)},{Header:"Guest Name",accessor:"guestname",Cell:i=>{var m,t;return l("div",{children:l("span",{className:"inline-flex items-center",children:l("span",{className:"text-sm text-slate-600 dark:text-slate-300",children:(m=i==null?void 0:i.cell)!=null&&m.value?(t=i==null?void 0:i.cell)==null?void 0:t.value:"Not Available"},void 0,!1,{fileName:a,lineNumber:30,columnNumber:29},void 0)},void 0,!1,{fileName:a,lineNumber:29,columnNumber:25},void 0)},void 0,!1,{fileName:a,lineNumber:28,columnNumber:21},void 0)}},{Header:"Booking Date",accessor:"reservation_date",Cell:i=>{var m,t;return l("span",{children:(m=i==null?void 0:i.cell)!=null&&m.value?new Date((t=i==null?void 0:i.cell)==null?void 0:t.value).toDateString():"Not Available"},void 0,!1,{fileName:a,lineNumber:43,columnNumber:24},void 0)}},{Header:"Confirmation Code",accessor:"confirmationcode",Cell:i=>{var m,t;return l("span",{children:(m=i==null?void 0:i.cell)!=null&&m.value?(t=i==null?void 0:i.cell)==null?void 0:t.value:"Not Available"},void 0,!1,{fileName:a,lineNumber:50,columnNumber:24},void 0)}},{Header:"Check in Date",accessor:"checkindate",Cell:i=>{var m,t;return l("span",{children:(m=i==null?void 0:i.cell)!=null&&m.value?new Date((t=i==null?void 0:i.cell)==null?void 0:t.value).toDateString():"Not Available"},void 0,!1,{fileName:a,lineNumber:57,columnNumber:24},void 0)}},{Header:"Check out Date",accessor:"checkoutdate",Cell:i=>{var m,t;return l("span",{children:(m=i==null?void 0:i.cell)!=null&&m.value?new Date((t=i==null?void 0:i.cell)==null?void 0:t.value).toDateString():"Not Available"},void 0,!1,{fileName:a,lineNumber:64,columnNumber:24},void 0)}},{Header:"NO OF NIGHTS STAYED",accessor:"nonight",Cell:i=>{var m,t;return l("span",{children:(m=i==null?void 0:i.cell)!=null&&m.value?(t=i==null?void 0:i.cell)==null?void 0:t.value:"0.00"},void 0,!1,{fileName:a,lineNumber:71,columnNumber:24},void 0)}},{Header:"RATE PER DAY",accessor:"tourismfee",Cell:i=>{var A,M,I,U,q,Y,K,V,W,k,J,Q;let m=(I=(M=(A=i==null?void 0:i.cell)==null?void 0:A.row)==null?void 0:M.original)!=null&&I.nonight?parseFloat((Y=(q=(U=i==null?void 0:i.cell)==null?void 0:U.row)==null?void 0:q.original)==null?void 0:Y.nonight):0,u=((W=(V=(K=i==null?void 0:i.cell)==null?void 0:K.row)==null?void 0:V.original)!=null&&W.roomrenthostpayable?parseFloat((Q=(J=(k=i==null?void 0:i.cell)==null?void 0:k.row)==null?void 0:J.original)==null?void 0:Q.roomrenthostpayable):0)/m;return l("span",{children:u?parseFloat(u).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})+" AED":"0.00"},void 0,!1,{fileName:a,lineNumber:83,columnNumber:21},void 0)}},{Header:"BOOKING AMOUNT",accessor:"roomrenthostpayable",Cell:i=>{var m,t;return l("span",{children:(m=i==null?void 0:i.cell)!=null&&m.value?parseFloat((t=i==null?void 0:i.cell)==null?void 0:t.value).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})+" AED":"0.00"},void 0,!1,{fileName:a,lineNumber:92,columnNumber:21},void 0)}}],F=r.exports.useMemo(()=>v,[]),x=r.exports.useMemo(()=>e),S=g.exports.useTable({columns:F,data:x,initialState:{pageIndex:0,pageSize:50}},g.exports.useGlobalFilter,g.exports.useSortBy,g.exports.usePagination,g.exports.useRowSelect),{getTableProps:b,getTableBodyProps:P,headerGroups:R,footerGroups:L,page:h,nextPage:E,previousPage:y,canNextPage:O,canPreviousPage:G,pageOptions:j,state:$,gotoPage:T,pageCount:s,setPageSize:c,setGlobalFilter:d,prepareRow:H}=S,[N,X]=r.exports.useState(0),[p,Z]=r.exports.useState(0),[_,D]=r.exports.useState(0);return r.exports.useEffect(()=>{var i;if(e!=null&&e.length){let m=0;for(let t=0;t<(e==null?void 0:e.length);t++){let u=parseFloat((i=e[t])==null?void 0:i.nonight);m+=u}X(m||0)}},[e==null?void 0:e.length]),r.exports.useEffect(()=>{if(e!=null&&e.length){let t=e.filter(u=>u.roomrenthostpayable!==void 0?u.roomrenthostpayable:null).map(u=>Number(u.roomrenthostpayable)).reduce((u,A)=>u+A,0);console.log("mmmmmmmmmmmm333",t),Z(t.toFixed(2))}},[e==null?void 0:e.length]),r.exports.useEffect(()=>{if(N&&p){let i=p/N;D(i)}},[N,p]),l(f,{children:l("div",{ref:C,children:[l("div",{className:"mt-[25px]",children:[l("div",{className:"flex gap-x-[10px]",children:[l("p",{className:"font-semibold",children:"Landlord Name: "},void 0,!1,{fileName:a,lineNumber:176,columnNumber:29},void 0),l("p",{className:"capitalize",children:n!=null&&n.owner_name?n==null?void 0:n.owner_name:"Not Avaiable"},void 0,!1,{fileName:a,lineNumber:177,columnNumber:29},void 0)]},void 0,!0,{fileName:a,lineNumber:175,columnNumber:25},void 0),l("div",{className:"flex gap-x-[10px]",children:[l("p",{className:"font-semibold",children:"Community Name: "},void 0,!1,{fileName:a,lineNumber:180,columnNumber:29},void 0),l("p",{className:"capitalize",children:n!=null&&n.communityname?n==null?void 0:n.communityname:"Not Avaiable"},void 0,!1,{fileName:a,lineNumber:181,columnNumber:29},void 0)]},void 0,!0,{fileName:a,lineNumber:179,columnNumber:25},void 0),l("div",{className:"flex gap-x-[10px]",children:[l("p",{className:"font-semibold",children:"Project Name: "},void 0,!1,{fileName:a,lineNumber:184,columnNumber:29},void 0),l("p",{className:"capitalize",children:n!=null&&n.project_name?n==null?void 0:n.project_name:"Not Avaiable"},void 0,!1,{fileName:a,lineNumber:185,columnNumber:29},void 0)]},void 0,!0,{fileName:a,lineNumber:183,columnNumber:25},void 0),l("div",{className:"flex gap-x-[10px]",children:[l("p",{className:"font-semibold",children:"Apartment No: "},void 0,!1,{fileName:a,lineNumber:188,columnNumber:29},void 0),l("p",{className:"capitalize",children:n!=null&&n.unitnumber?n==null?void 0:n.unitnumber:"Not Avaiable"},void 0,!1,{fileName:a,lineNumber:189,columnNumber:29},void 0)]},void 0,!0,{fileName:a,lineNumber:187,columnNumber:25},void 0),l("div",{className:"flex gap-x-[10px]",children:[l("p",{className:"font-semibold",children:"Building No: "},void 0,!1,{fileName:a,lineNumber:192,columnNumber:29},void 0),l("p",{className:"capitalize",children:n!=null&&n.building_name?n==null?void 0:n.building_name:"Not Avaiable"},void 0,!1,{fileName:a,lineNumber:193,columnNumber:29},void 0)]},void 0,!0,{fileName:a,lineNumber:191,columnNumber:25},void 0)]},void 0,!0,{fileName:a,lineNumber:174,columnNumber:21},void 0),l("div",{className:"overflow-x-auto -mx-6 mt-6",children:l("div",{className:"inline-block min-w-full align-middle",children:l("div",{className:"",children:l("table",{className:"min-w-[100%] overflow-x-scroll divide-y divide-slate-100 table-fixed dark:divide-slate-700",...b,children:[l("thead",{className:"bg-slate-200 dark:bg-slate-700",children:R.map(i=>l("tr",{...i.getHeaderGroupProps(),children:i.headers.map(m=>l("th",{...m.getHeaderProps(m.getSortByToggleProps()),scope:"col",className:"table-th",children:[m.render("Header"),l("span",{children:m.isSorted?m.isSortedDesc?" \u{1F53D}":" \u{1F53C}":""},void 0,!1,{fileName:a,lineNumber:214,columnNumber:61},void 0)]},void 0,!0,{fileName:a,lineNumber:208,columnNumber:57},void 0))},void 0,!1,{fileName:a,lineNumber:205,columnNumber:45},void 0))},void 0,!1,{fileName:a,lineNumber:203,columnNumber:37},void 0),l("tbody",{className:"bg-white divide-y divide-slate-100 dark:bg-slate-800 dark:divide-slate-700",...P,children:[h&&h.length>0&&h.map(i=>(H(i),l(f,{children:l("tr",{...i.getRowProps(),children:i.cells.map(m=>l("td",{...m.getCellProps(),className:"table-td",children:m.render("Cell")},void 0,!1,{fileName:a,lineNumber:235,columnNumber:65},void 0))},void 0,!1,{fileName:a,lineNumber:232,columnNumber:53},void 0)},void 0,!1))),l("tr",{children:[l("td",{},void 0,!1,{fileName:a,lineNumber:245,columnNumber:45},void 0),l("td",{},void 0,!1,{fileName:a,lineNumber:246,columnNumber:45},void 0),l("td",{},void 0,!1,{fileName:a,lineNumber:247,columnNumber:45},void 0),l("td",{},void 0,!1,{fileName:a,lineNumber:248,columnNumber:45},void 0),l("td",{},void 0,!1,{fileName:a,lineNumber:249,columnNumber:45},void 0),l("td",{},void 0,!1,{fileName:a,lineNumber:250,columnNumber:45},void 0),l("td",{className:"table-td",children:(N==null?void 0:N.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))+" Nights"},void 0,!1,{fileName:a,lineNumber:251,columnNumber:45},void 0),l("td",{className:"table-td",children:(_==null?void 0:_.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))+" AED"},void 0,!1,{fileName:a,lineNumber:254,columnNumber:45},void 0),l("td",{className:"table-td",children:(p==null?void 0:p.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))+" AED"},void 0,!1,{fileName:a,lineNumber:257,columnNumber:45},void 0)]},void 0,!0,{fileName:a,lineNumber:244,columnNumber:41},void 0)]},void 0,!0,{fileName:a,lineNumber:223,columnNumber:37},void 0)]},void 0,!0,{fileName:a,lineNumber:199,columnNumber:33},void 0)},void 0,!1,{fileName:a,lineNumber:198,columnNumber:29},void 0)},void 0,!1,{fileName:a,lineNumber:197,columnNumber:25},void 0)},void 0,!1,{fileName:a,lineNumber:196,columnNumber:21},void 0)]},void 0,!0,{fileName:a,lineNumber:173,columnNumber:17},void 0)},void 0,!1)});var o="D:\\Ahsan\\Rare\\Dev\\Rare_Frontend\\src\\pages\\booking-management\\booking-report\\AllReport.jsx";const ae={option:(e,n)=>({...e,fontSize:"14px"})},re=()=>{var T;const[e,n]=r.exports.useState({propertyid:"",filteredDates:[]}),[z,C]=r.exports.useState([]),[v,F]=r.exports.useState(""),[x,S]=r.exports.useState(""),[b,P]=r.exports.useState([]),[R,L]=r.exports.useState(""),[h,E]=r.exports.useState(!1);r.exports.useEffect(()=>{fetch("http://stg.srp.ai/property").then(s=>s.json()).then(s=>{const c=s==null?void 0:s.map(d=>({label:d.unitnumber+" | "+d.communityname+" | "+d.projectname+" | "+d.buildingname,value:d._id}));P(c)})},[]),r.exports.useEffect(()=>{(async()=>{if(e!=null&&e.propertyid){const d=await(await fetch(`http://stg.srp.ai/property/${e==null?void 0:e.propertyid}`)).json();d&&L(d)}})()},[e==null?void 0:e.propertyid]),r.exports.useEffect(()=>{(async()=>{const d=await(await fetch("http://stg.srp.ai/booking")).json();F(d)})()},[]);const[y,O]=r.exports.useState({startDate:"",endDate:""}),G=r.exports.useRef(null);r.exports.useEffect(()=>{if(v!=null&&v.length&&(e==null?void 0:e.propertyid)&&(e==null?void 0:e.startDate)&&(e==null?void 0:e.endDate)){const s=v.filter(c=>{let d=!0;return e.propertyid&&c.propertyid!==e.propertyid&&(d=!1),(c==null?void 0:c.checkindate)<(e==null?void 0:e.startDate)&&(c==null?void 0:c.checkindate)>(e==null?void 0:e.endDate)&&(d=!1),d});C(s)}},[e==null?void 0:e.propertyid,e==null?void 0:e.startDate,e==null?void 0:e.endDate,v]),console.log(e,"setUserData"),console.log(z,"allBooking");const j=()=>{S(""),n({...e,filteredDates:[]}),O({startDate:null,endDate:null})},$=async s=>{if(E(!0),console.log("newValue",s),S(s),!s){n({...e,filteredDates:[]});return}const H=(await(await fetch(`http://stg.srp.ai/booking/api/reservationdate?ownerid=${e==null?void 0:e._id}&${e!=null&&e.propertyid?"propertyid="+(e==null?void 0:e.propertyid)+"&":""}checkindate=${s.startDate}&checkindate=${s.endDate}`)).json()).filter(N=>N.propertyid===e.propertyid&&N.cancelled===!1);E(!1),n({...e,filteredDates:H})};return l(f,{children:l("div",{className:"xl:col-span-2 col-span-1",children:l(w,{title:"Booking Report",children:[l("div",{className:"flex flex-row-reverse"},void 0,!1,{fileName:o,lineNumber:187,columnNumber:21},void 0),l("div",{children:[l("form",{className:"lg:grid-cols-3 grid gap-5 grid-cols-1 ",children:[l("div",{className:"w-[100%] col-span-3",children:l("h4",{className:"text-base text-slate-800 dark:text-slate-300 mb-[0.5rem] mt-[0.5rem]",children:"Select Property"},void 0,!1,{fileName:o,lineNumber:196,columnNumber:33},void 0)},void 0,!1,{fileName:o,lineNumber:195,columnNumber:29},void 0),l("div",{className:"w-[100%] col-span-3",children:l(ee,{label:"Basic Select",className:"react-select",classNamePrefix:"select",options:b,value:b&&x?b.filter(function(s){return s.value===(e==null?void 0:e.propertyid)}):b.filter(function(s){return s.value===(e==null?void 0:e.propertyid)}),onChange:s=>{x?j():n({...e,propertyid:s==null?void 0:s.value})},styles:ae,id:"hh",placeholder:"Select and Search property"},void 0,!1,{fileName:o,lineNumber:204,columnNumber:33},void 0)},void 0,!1,{fileName:o,lineNumber:200,columnNumber:29},void 0)]},void 0,!0,{fileName:o,lineNumber:191,columnNumber:25},void 0),e.propertyid&&l(f,{children:l("div",{className:"flex justify-end mt-[25px]",children:[l("div",{className:"w-[150px]",children:l("div",{className:"date-range-custom relative",children:l(le,{value:y,inputClassName:"input-class",containerClassName:"container-class",onChange:$,placeholder:"SELECT DATE"},void 0,!1,{fileName:o,lineNumber:252,columnNumber:49},void 0)},void 0,!1,{fileName:o,lineNumber:251,columnNumber:45},void 0)},void 0,!1,{fileName:o,lineNumber:250,columnNumber:41},void 0),x&&l("div",{className:"flex justify-end",children:l("div",{className:"w-[90px]",children:l("div",{className:"date-range-custom relative",children:l("button",{className:"btn btn-dark text-white  text-center",type:"button",onClick:j,children:"Reset"},void 0,!1,{fileName:o,lineNumber:266,columnNumber:45},void 0)},void 0,!1,{fileName:o,lineNumber:265,columnNumber:45},void 0)},void 0,!1,{fileName:o,lineNumber:264,columnNumber:41},void 0)},void 0,!1,{fileName:o,lineNumber:263,columnNumber:25},void 0)]},void 0,!0,{fileName:o,lineNumber:249,columnNumber:37},void 0)},void 0,!1)]},void 0,!0,{fileName:o,lineNumber:190,columnNumber:21},void 0),h===!0?l(f,{children:l("div",{className:"flex items-center justify-center h-[100%]",children:l("svg",{className:"animate-spin ltr:-ml-1 ltr:mr-3 rtl:-mr-1 rtl:ml-3 h-60 w-60",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[l("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"},void 0,!1,{fileName:o,lineNumber:289,columnNumber:37},void 0),l("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},void 0,!1,{fileName:o,lineNumber:297,columnNumber:37},void 0)]},void 0,!0,{fileName:o,lineNumber:283,columnNumber:33},void 0)},void 0,!1,{fileName:o,lineNumber:282,columnNumber:29},void 0)},void 0,!1):(T=e.filteredDates)!=null&&T.length?l(f,{children:l(ie,{loadingPropertyforData:h,allBooking:e.filteredDates,propertyData:R,ref:G},void 0,!1,{fileName:o,lineNumber:308,columnNumber:29},void 0)},void 0,!1):l(f,{children:l("h6",{className:"text-base text-slate-800 dark:text-slate-300 mb-[0.5rem] mt-[0.5rem]",children:"No Property Data Found"},void 0,!1,{fileName:o,lineNumber:312,columnNumber:30},void 0)},void 0,!1)]},void 0,!0,{fileName:o,lineNumber:186,columnNumber:17},void 0)},void 0,!1,{fileName:o,lineNumber:185,columnNumber:13},void 0)},void 0,!1)};export{re as default};
