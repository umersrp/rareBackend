import{R as G,j as t,F as X,r as m,b as c,C as V,I,an as U,z as re,ca as de}from"./index.5e55c1ba.js";/* empty css                     */import{r as H}from"./index.c89ffb9d.js";import{G as me}from"./GlobalFilter.2b1d860a.js";import"./index.esm.c068ea99.js";import{G as ue}from"./group-chart-1.095f32b1.js";import"./react-apexcharts.min.f6d70275.js";const W=G.forwardRef(({indeterminate:h,...b},E)=>{const n=G.useRef(),g=E||n;return G.useEffect(()=>{g.current.indeterminate=h},[g,h]),t(X,{children:t("input",{type:"checkbox",ref:g,...b,className:"table-checkbox"})})}),O={option:(h,b)=>({...h,fontSize:"14px"})},pe=({title:h,linktitle:b,pagelink:E,allData:n,forFilterData:g,handleFilterSearch:L,handleClearFilter:v})=>{const[s,x]=m.exports.useState(""),[o,R]=m.exports.useState(!1),A=e=>{const{name:l,value:a}=e.target;x({...s,[l]:a})},$=[{Header:"Sr no",accessor:"id",Cell:({row:e,flatRows:l})=>t("span",{children:l.indexOf(e)+1})},{Header:"Booking Status",accessor:"cancelled",Cell:e=>{var l,a,i;return t("span",{className:"block w-full",children:t("span",{className:` inline-block px-3 min-w-[90px] text-center mx-auto py-1 rounded-[999px] bg-opacity-25 ${((l=e==null?void 0:e.cell)==null?void 0:l.value)===!1?"text-success-500 bg-success-500":""} 
            ${((a=e==null?void 0:e.cell)==null?void 0:a.value)===!0?"text-danger-500 bg-danger-500":""}
            
             `,children:((i=e==null?void 0:e.cell)==null?void 0:i.value)===!0?"Cancelled":"Approved"})})}},{Header:"booking number",accessor:"bookingnumber",Cell:e=>{var l,a,i;return t("span",{children:(l=e==null?void 0:e.cell)!=null&&l.value?((a=e==null?void 0:e.cell)==null?void 0:a.value.slice(0,15))+(((i=e==null?void 0:e.cell)==null?void 0:i.value.length)>15?"...":""):"Not Available"})}},{Header:"confirmation code",accessor:"confirmationcode",Cell:e=>{var l,a,i,r;return t("div",{children:t("span",{className:"inline-flex items-center",children:t("span",{className:"text-sm text-slate-600 dark:text-slate-300 lowercase",children:(l=e==null?void 0:e.cell)!=null&&l.value?((a=e==null?void 0:e.cell)==null?void 0:a.value.slice(0,15))+(((r=(i=e==null?void 0:e.cell)==null?void 0:i.value)==null?void 0:r.length)>15?"...":""):"Not Available"})})})}},{Header:"guest name",accessor:"guestname",Cell:e=>{var l,a,i,r,f;return t("span",{children:(l=e==null?void 0:e.cell)!=null&&l.value?((i=(a=e==null?void 0:e.cell)==null?void 0:a.value)==null?void 0:i.slice(0,15))+(((f=(r=e==null?void 0:e.cell)==null?void 0:r.value)==null?void 0:f.length)>15?"...":""):"Not Available"})}},{Header:"unit number",accessor:"unitnumber",Cell:e=>{var l,a,i,r,f;return t("span",{children:(l=e==null?void 0:e.cell)!=null&&l.value?((i=(a=e==null?void 0:e.cell)==null?void 0:a.value)==null?void 0:i.slice(0,15))+(((f=(r=e==null?void 0:e.cell)==null?void 0:r.value)==null?void 0:f.length)>15?"...":""):"Not Available"})}},{Header:"booking agent",accessor:"bookingagent",Cell:e=>{var l,a,i,r,f;return t("span",{children:(l=e==null?void 0:e.cell)!=null&&l.value?((i=(a=e==null?void 0:e.cell)==null?void 0:a.value)==null?void 0:i.slice(0,15))+(((f=(r=e==null?void 0:e.cell)==null?void 0:r.value)==null?void 0:f.length)>15?"...":""):"Not Available"})}},{Header:"checkin date",accessor:"checkindate",Cell:e=>{var l,a;return t("span",{children:(l=e==null?void 0:e.cell)!=null&&l.value?new Date((a=e==null?void 0:e.cell)==null?void 0:a.value).toDateString():"Not Available"})}},{Header:"checkout date",accessor:"checkoutdate",Cell:e=>{var l,a;return t("span",{children:(l=e==null?void 0:e.cell)!=null&&l.value?new Date((a=e==null?void 0:e.cell)==null?void 0:a.value).toDateString():"Not Available"})}},{Header:"Room Rent Amount: (host Payable)",accessor:"roomrenthostpayable",Cell:e=>{var l,a;return t("span",{children:(l=e==null?void 0:e.cell)!=null&&l.value?parseFloat((a=e==null?void 0:e.cell)==null?void 0:a.value).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})+" AED":"0.00"})}},{Header:"Host Management Fee",accessor:"hostmanagementfee",Cell:e=>{var l,a;return t("span",{children:(l=e==null?void 0:e.cell)!=null&&l.value?((a=e==null?void 0:e.cell)==null?void 0:a.value.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))+" AED":"0.00"})}},{Header:"created-on",accessor:"createdAt",Cell:e=>{var l,a;return t("span",{children:(l=e==null?void 0:e.cell)!=null&&l.value?new Date((a=e==null?void 0:e.cell)==null?void 0:a.value).toDateString():"Not Available"})}}],p=m.exports.useMemo(()=>$,[]),k=m.exports.useMemo(()=>n),N=H.exports.useTable({columns:p,data:k,initialState:{pageIndex:0,pageSize:50}},H.exports.useGlobalFilter,H.exports.useSortBy,H.exports.usePagination,H.exports.useRowSelect,e=>{e.visibleColumns.push(l=>[{id:"selection",Header:({getToggleAllRowsSelectedProps:a})=>t("div",{children:t(W,{...a()})}),Cell:({row:a})=>t("div",{children:t(W,{...a.getToggleRowSelectedProps()})})},...l])}),{getTableProps:u,getTableBodyProps:j,headerGroups:C,footerGroups:_,page:q,nextPage:z,previousPage:T,canNextPage:P,canPreviousPage:y,pageOptions:S,state:B,gotoPage:d,pageCount:F,setPageSize:Z,setGlobalFilter:D,prepareRow:w}=N,{globalFilter:ee,pageIndex:M,pageSize:te}=B,[Y,le]=m.exports.useState(0);m.exports.useEffect(()=>{var e,l;if(n!=null&&n.length){let a=0;for(let i=0;i<(n==null?void 0:n.length);i++){let r=parseFloat((e=n[i])==null?void 0:e.roomrentamount);!isNaN(r)&&((l=n[i])==null?void 0:l.cancelled)===!1&&(a+=r)}le(a||0)}},[n==null?void 0:n.length]);const[ae,se]=m.exports.useState(0);m.exports.useEffect(()=>{if(n!=null&&n.length){let e=n==null?void 0:n.filter(l=>l.cancelled===!1).length;se(e)}},[n]);const ne=[{name:{series:[{data:[800,600,1e3,800,600,1e3,800,900]}],options:{chart:{toolbar:{autoSelected:"pan",show:!1},offsetX:0,offsetY:0,zoom:{enabled:!1},sparkline:{enabled:!0}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:2},colors:["#00EBFF"],tooltip:{theme:"light"},grid:{show:!1,padding:{left:0,right:0}},yaxis:{show:!1},fill:{type:"solid",opacity:[.1]},legend:{show:!1},xaxis:{low:0,offsetX:0,offsetY:0,show:!1,labels:{low:0,offsetX:0,show:!1},axisBorder:{low:0,offsetX:0,show:!1}}}},title:"Total No of Check-In",count:ae,bg:"bg-[#E5F9FF] dark:bg-slate-900	"},{name:{series:[{data:[800,600,1e3,800,600,1e3,800,900]}],options:{chart:{toolbar:{autoSelected:"pan",show:!1},offsetX:0,offsetY:0,zoom:{enabled:!1},sparkline:{enabled:!0}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:2},colors:["#FB8F65"],tooltip:{theme:"light"},grid:{show:!1,padding:{left:0,right:0}},yaxis:{show:!1},fill:{type:"solid",opacity:[.1]},legend:{show:!1},xaxis:{low:0,offsetX:0,offsetY:0,show:!1,labels:{low:0,offsetX:0,show:!1},axisBorder:{low:0,offsetX:0,show:!1}}}},title:"Total Collection",count:Y?Y.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})+" AED":0,bg:"bg-[#FFEDE5] dark:bg-slate-900	"}],ie=g.filter(e=>e.unitnumber!==void 0),J=[...new Set(ie.map(e=>e.unitnumber))].sort((e,l)=>e.localeCompare(l,void 0,{sensitivity:"base"})).map(e=>({label:e,value:e})),ce=g.filter(e=>e.email!==void 0),K=[...[...new Set(ce.map(e=>e.email))].map(e=>{const l=g.find(a=>a.email===e);return l?{label:l.guestname+" | "+l.email,value:l.email}:null}).filter(Boolean)].sort((e,l)=>e.label.localeCompare(l.label)),Q=[...[{value:"Airbnb",label:"Airbnb"},{value:"Booking.com",label:"Booking.com"},{value:"vrbo",label:"vrbo"},{value:"Direct Booking",label:"Direct Booking"},{value:"Not in the List",label:"Not in the List"}]].sort((e,l)=>e.label.localeCompare(l.label)),oe=()=>{v(),x("")};return t(X,{children:c(V,{children:[t("div",{className:"grid grid-cols-12 gap-5 mb-5",children:t("div",{className:"2xl:col-span-12 lg:col-span-12 col-span-12",children:t(V,{bodyClass:"p-4",children:t("div",{className:"grid md:grid-cols-2 col-span-1 gap-4",children:t(ue,{statistics:ne})})})})}),c("div",{className:"flex justify-between items-center mb-6",children:[t("h4",{className:"card-title",children:h}),c("div",{className:"md:flex justify-end items-center mb-6 gap-x-[25px]",children:[c("button",{className:"h-[34px] rounded-[10px] relative bg-white border1px flex items-center gap-x-[10px] justify-around px-[10px] py-[5px] cursor-pointer md:mb-0 mb-4",onClick:()=>R(!o),children:[o===!0?t(I,{icon:"heroicons:minus-small",className:"w-[20px] h-[20px]"}):t(I,{icon:"heroicons:plus-small",className:"w-[20px] h-[20px]"}),t("p",{className:"text-[16px] leading regular color-black",children:"Advance filter"})]}),t(me,{filter:ee,setFilter:D})]})]}),c("div",{className:`xl:grid-cols-3 grid gap-5 grid-cols-1 ${o===!0?"filter-show mt-6 pointer-events-auto":"filter-remove -mt-4 pointer-events-none"}`,children:[c("div",{children:[t("label",{htmlFor:" hh",className:"form-label ",children:"Unit No."}),t(U,{label:"Basic Select",className:"react-select",classNamePrefix:"select",options:J,value:J.filter(function(e){if((s==null?void 0:s.unitnumber)!=="")return e.value===(s==null?void 0:s.unitnumber)}),onChange:e=>{A({target:{name:"unitnumber",value:e.value}})},styles:O,id:"hh",placeholder:"Select..."}),s!=null&&s.unitnumber?t("div",{className:" mt-2 block text-sm cursor-pointer",onClick:()=>x({...s,unitnumber:""}),children:"Clear filter"}):null]}),c("div",{children:[t("label",{htmlFor:" hh",className:"form-label ",children:"Guest Name / Email"}),t(U,{label:"Basic Select",className:"react-select",classNamePrefix:"select",options:K,value:K.filter(function(e){if((s==null?void 0:s.email)!=="")return e.value===(s==null?void 0:s.email)}),onChange:e=>{A({target:{name:"email",value:e.value}})},styles:O,id:"hh",placeholder:"Select..."}),s!=null&&s.email?t("div",{className:" mt-2 block text-sm cursor-pointer",onClick:()=>x({...s,email:""}),children:"Clear filter"}):null]}),c("div",{children:[t("label",{htmlFor:" hh",className:"form-label ",children:"Booking Agent"}),t(U,{label:"Basic Select",className:"react-select",classNamePrefix:"select",options:Q,value:Q.filter(function(e){if((s==null?void 0:s.bookingagent)!=="")return e.value===(s==null?void 0:s.bookingagent)}),onChange:e=>{A({target:{name:"bookingagent",value:e.value}})},styles:O,id:"hh",placeholder:"Select..."}),s!=null&&s.bookingagent?t("div",{className:" mt-2 block text-sm cursor-pointer",onClick:()=>x({...s,bookingagent:""}),children:"Clear filter"}):null]})]}),c("div",{className:`flex ${o===!0?"filter-show mt-6 pointer-events-auto":"filter-remove mt-0 pointer-events-none"} justify-end gap-x-[10px]`,children:[t("button",{className:"btn btn-secondary  text-center",type:"button",onClick:()=>oe(),children:"Clear filter"}),t("button",{className:"btn btn-dark  text-center",type:"button",onClick:()=>L(s),children:"Search"})]}),t("div",{className:"overflow-x-auto -mx-6 mt-6",children:t("div",{className:"inline-block min-w-full align-middle",children:t("div",{className:"overflow-hidden ",children:c("table",{className:"min-w-full divide-y divide-slate-100 table-fixed dark:divide-slate-700",...u,children:[t("thead",{className:"bg-slate-200 dark:bg-slate-700",children:C.map(e=>t("tr",{...e.getHeaderGroupProps(),children:e.headers.map(l=>c("th",{...l.getHeaderProps(l.getSortByToggleProps()),scope:"col",className:" table-th ",children:[l.render("Header"),t("span",{children:l.isSorted?l.isSortedDesc?" \u{1F53D}":" \u{1F53C}":""})]}))}))}),t("tbody",{className:"bg-white divide-y divide-slate-100 dark:bg-slate-800 dark:divide-slate-700",...j,children:q.map(e=>(w(e),t("tr",{...e.getRowProps(),children:e.cells.map(l=>t("td",{...l.getCellProps(),className:"table-td",children:l.render("Cell")}))})))})]})})})}),c("div",{className:"md:flex md:space-y-0 space-y-5 justify-between mt-6 items-center",children:[c("div",{className:" flex items-center space-x-3 rtl:space-x-reverse",children:[t("select",{className:"form-control py-2 w-max",value:te,onChange:e=>Z(Number(e.target.value)),children:[50,100,200].map(e=>c("option",{value:e,children:["Show ",e]},e))}),c("span",{className:"text-sm font-medium text-slate-600 dark:text-slate-300",children:["Page"," ",c("span",{children:[M+1," of ",S.length]})]})]}),c("ul",{className:"flex items-center  space-x-3  rtl:space-x-reverse",children:[t("li",{className:"text-xl leading-4 text-slate-900 dark:text-white rtl:rotate-180",children:t("button",{className:` ${y?"":"opacity-50 cursor-not-allowed"}`,onClick:()=>d(0),disabled:!y,children:t(I,{icon:"heroicons:chevron-double-left-solid"})})}),t("li",{className:"text-sm leading-4 text-slate-900 dark:text-white rtl:rotate-180",children:t("button",{className:` ${y?"":"opacity-50 cursor-not-allowed"}`,onClick:()=>T(),disabled:!y,children:"Prev"})}),S.map((e,l)=>t("li",{children:t("button",{href:"#","aria-current":"page",className:` ${l===M?"bg-slate-900 dark:bg-slate-600  dark:text-slate-200 text-white font-medium ":"bg-slate-100 dark:bg-slate-700 dark:text-slate-400 text-slate-900  font-normal  "}    text-sm rounded leading-[16px] flex h-6 w-6 items-center justify-center transition-all duration-150`,onClick:()=>d(l),children:e+1})},l)),t("li",{className:"text-sm leading-4 text-slate-900 dark:text-white rtl:rotate-180",children:t("button",{className:` ${P?"":"opacity-50 cursor-not-allowed"}`,onClick:()=>z(),disabled:!P,children:"Next"})}),t("li",{className:"text-xl leading-4 text-slate-900 dark:text-white rtl:rotate-180",children:t("button",{onClick:()=>d(F-1),disabled:!P,className:` ${P?"":"opacity-50 cursor-not-allowed"}`,children:t(I,{icon:"heroicons:chevron-double-right-solid"})})})]})]})]})})},Be=()=>{const[h,b]=m.exports.useState(!1),[E,n]=m.exports.useState([]),[g,L]=m.exports.useState(""),[v,s]=m.exports.useState(""),x=localStorage.getItem("isAuth"),o=JSON.parse(x),R=re();m.exports.useEffect(()=>{b(!0),o!=null&&o.type?(async()=>{try{const k=`http://dev-rare.srp.ai/property/api/advancesearch?customerid=${o==null?void 0:o._id}&sort=descending&type=customer&page=0&perPage=all`,N=`http://dev-rare.srp.ai/property/api/advancesearch?owner_representative_id=${o==null?void 0:o._id}&sort=descending&type=customer&page=0&perPage=all`,u=await fetch(k);if(!u.ok&&u.status!==400)throw new Error(`API 1 failed with status: ${u.status}`);const j=u.status===400?[]:await u.json(),C=await fetch(N);if(!C.ok&&C.status!==400)throw new Error(`API 2 failed with status: ${C.status}`);const _=C.status===400?[]:await C.json(),T=[...j,..._].map(d=>d._id).map(d=>fetch(`http://dev-rare.srp.ai/booking/ownerrepresentative/pages?propertyid=${d}&page=0&perPage=all`).then(F=>F.json())),y=(await Promise.all(T)).reduce((d,F)=>d.concat(F),[]),S=new Map;y.forEach(d=>{S.has(d._id)||S.set(d._id,d)});const B=Array.from(S.values());n(B),L(B),s(B)}catch(k){console.error("Error fetching data:",k),b(!1)}})():setTimeout(()=>{R("/access-denied")},1e3),b(!1)},[o==null?void 0:o.type,h]);function A(p){if(p){const k=v.filter(N=>{let u=!0;return p.unitnumber&&N.unitnumber!==p.unitnumber&&(u=!1),p.email&&N.email!==p.email&&(u=!1),p.bookingagent&&N.bookingagent!==p.bookingagent&&(u=!1),u});n(k)}else n(v)}const $=async()=>{n(v)};return t(X,{children:c("div",{className:" space-y-5",children:[h&&!v.length?t(de,{}):null,v.length>0?t(pe,{pagelink:"/add-property",linktitle:"Add new Property",title:"All Booking",allData:E,forFilterData:g,handleFilterSearch:A,handleClearFilter:$}):"no booking found"]})})};export{Be as default};
