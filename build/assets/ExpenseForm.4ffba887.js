import{A as ae,ag as le,r as s,w as ne,x as N,an as re,y as oe,j as t,F as m,C as ie,c as i,aq as L,aC as se,l as T,ao as ce,K as B,z as de}from"./index.f2f04dad.js";const O={option:(u,_)=>({...u,fontSize:"14px"})},he=()=>{var G;const u=ae(),_=le();let w=window.location.href.split("/"),f=w[w.length-1];const[x,v]=s.exports.useState(!1),[e,p]=s.exports.useState(""),[d,j]=s.exports.useState(""),[A,pe]=s.exports.useState(""),[S,R]=s.exports.useState([]);s.exports.useState([]);const[k,V]=s.exports.useState([]),[C,I]=s.exports.useState(""),[F,K]=s.exports.useState(""),[q,M]=s.exports.useState(""),[g,Y]=s.exports.useState(""),[P,H]=s.exports.useState(""),[E,J]=s.exports.useState(""),Q=l=>{I(l.target.files[0]),p({...e,titledeeddocument:l.target.files[0]})},W=async()=>{v(!0),(!e.propertyid||!d._id||!e.amount||!e.d_o_p)&&U();const l=new FormData;l.append("propertyid",e.propertyid),l.append("purposeid",d._id),l.append("amount",e.amount),l.append("d_o_p",new Date(e.d_o_p)),e.titledeeddocument&&l.append("expenseAttachment",e.titledeeddocument);const r="http://dev-rare.srp.ai/expense/create",a=l,c=await B.post(r,a,{headers:{"Content-Type":"multipart/form-data"}});v(!1),c.status===201&&c.data.status===!0&&u("/all-expenseform")},X=()=>{u("/all-expenseform")},Z=async l=>{var n;console.log("UUUUU",l),(!l.propertyid||!d._id||!l.amount||!l.d_o_p)&&U(),v(!0);const r=new FormData;r.append("propertyid",l.propertyid._id?l.propertyid._id:l.propertyid),r.append("purposeid",d._id?d._id:l.purposeid._id),r.append("amount",l.amount),r.append("d_o_p",new Date(l.d_o_p)),l.titledeeddocument&&r.append("expenseAttachment",l.titledeeddocument);const a=`http://dev-rare.srp.ai/expense/update/${l._id}`,c=r,o=await B.put(a,c,{headers:{"Content-Type":"multipart/form-data"}});v(!1),(o==null?void 0:o.status)===201&&((n=o==null?void 0:o.data)==null?void 0:n.status)===!0&&u("/all-expenseform")};console.log("userData======>",e);let D={propertyid:"Property",purposeid:"Purpose",amount:"Amount",d_o_p:"Date of Payment",expenseAttachment:"Attachment"};const ee=ne({propertyid:N().required(F),purposeid:N().required(q),amount:re().required(g),d_o_p:N().required(P),expenseAttachment:N().required(E)}).required(),{register:$,formState:{errors:me}}=oe({resolver:de(ee)}),U=()=>{let l=!1,r={propertyid:K,purposeid:M,amount:Y,d_o_p:H,expenseAttachment:J};return r&&Object.keys(r).length&&Object.keys(r).map(a=>{r[a](""),e[a]||(r[a](D[a]+" is required"),l=!0)}),l};s.exports.useEffect(()=>{f&&fetch(`http://dev-rare.srp.ai/expense/get/${f}`).then(l=>l.json()).then(l=>{var r;(r=l==null?void 0:l.data)==null||r.map(a=>{p(a)})})},[f]),s.exports.useEffect(()=>{const l=()=>{fetch("http://dev-rare.srp.ai/property").then(a=>a.json()).then(a=>{const c=a==null?void 0:a.map(o=>({label:o.unitnumber+" | "+o.communityname+" | "+o.projectname+" | "+o.buildingname,value:o._id}));R(c)})},r=()=>{fetch("http://dev-rare.srp.ai/purpose/get").then(a=>a.json()).then(a=>{var o;const c=(o=a==null?void 0:a.data)==null?void 0:o.map(n=>({label:n.name,value:n._id}));V(c)})};l(),r()},[]),s.exports.useEffect(()=>{(async()=>{if(e!=null&&e.propertyid){const a=await(await fetch(`http://dev-rare.srp.ai/property/${e==null?void 0:e.propertyid}`)).json();a&&p({...e,unitnumber:a==null?void 0:a.unitnumber,buildingname:a==null?void 0:a.buildingname,floor:a==null?void 0:a.floor,buildingnumber:a==null?void 0:a.buildingnumber,projectname:a==null?void 0:a.projectname,communityname:a==null?void 0:a.communityname,city:a==null?void 0:a.propertycity,ownerid:a==null?void 0:a.customerid})}})()},[e==null?void 0:e.propertyid]),s.exports.useEffect(()=>{const l=async()=>{var a,c;if((a=e==null?void 0:e.propertyid)!=null&&a._id){const n=await(await fetch(`http://dev-rare.srp.ai/property/${(c=e==null?void 0:e.propertyid)==null?void 0:c._id}`)).json();n&&p({...e,unitnumber:n==null?void 0:n.unitnumber,buildingname:n==null?void 0:n.buildingname,floor:n==null?void 0:n.floor,buildingnumber:n==null?void 0:n.buildingnumber,projectname:n==null?void 0:n.projectname,communityname:n==null?void 0:n.communityname,city:n==null?void 0:n.propertycity,ownerid:n==null?void 0:n.customerid})}},r=async()=>{var a,c;if((a=e==null?void 0:e.propertyid)!=null&&a._id){const n=await(await fetch(`http://dev-rare.srp.ai/property/${(c=h==null?void 0:h.propertyid)==null?void 0:c._id}`)).json();let b=[];b.push(n);const h=b==null?void 0:b.map(y=>({label:y.unitnumber+" | "+y.communityname+" | "+y.projectname+" | "+y.buildingname,value:y._id}));console.log("fffff",h),p(h)}};l(),r()},[(G=e==null?void 0:e.propertyid)==null?void 0:G._id]),s.exports.useEffect(()=>{(async()=>{var a;const r=e.purposeid._id;if(r){const o=await(await fetch(`http://dev-rare.srp.ai/purpose/get/${r}`)).json();o.data&&j({...d,name:(a=o==null?void 0:o.data)==null?void 0:a.name})}})()},[e]),console.log("purposeuserData",d);const z=l=>{const{name:r,value:a}=l.target;p({...e,[r]:a})},te=l=>{const{name:r,value:a}=l.target;p({...e,[r]:a})};return t(m,{children:t("div",{className:"xl:col-span-2 col-span-1",children:t(ie,{title:"Expenses Form",children:t("div",{children:i("form",{className:"lg:grid-cols-3 grid gap-5 grid-cols-1 ",children:[t("div",{className:"w-[100%] col-span-3",children:t("h4",{className:"text-base text-slate-800 dark:text-slate-300 mb-[0.5rem] mt-[0.5rem]",children:"PROPERTY DETAILS"})}),i("div",{className:"w-[100%] col-span-3",children:[t("label",{htmlFor:" hh",className:"form-label ",children:"Enter your Property"}),t(L,{label:"Basic Select",className:"react-select",classNamePrefix:"select",options:S,value:S.filter(function(l){return l.value===(e==null?void 0:e.propertyid)}),onChange:l=>{p({...e,propertyid:l==null?void 0:l.value})},styles:O,id:"hh",placeholder:"Select and Search property"}),t("div",{className:"flex items-center justify-between",children:t("div",{className:" text-danger-500 block text-sm",children:e!=null&&e.propertyid?null:F})})]}),t(m,{children:e.propertyid?i(m,{children:[i("div",{className:"fromGroup       ",children:[t("label",{className:"block capitalize form-label  ",children:"Unit number"}),i("div",{className:"relative ",children:[t("input",{type:"text",name:"unitnumer",className:"  form-control py-2   ",placeholder:"Add placeholder",readonly:"",value:e?e.unitnumber:e.propertyid?e.propertyid.unitnumber:"Not Available"}),t("div",{className:"flex text-xl absolute ltr:right-[14px] rtl:left-[14px] top-1/2 -translate-y-1/2  space-x-1 rtl:space-x-reverse"})]})]}),i("div",{className:"fromGroup       ",children:[t("label",{className:"block capitalize form-label  ",children:"Community Name"}),i("div",{className:"relative ",children:[t("input",{type:"text",name:"communityname",className:"  form-control py-2   ",placeholder:"Add placeholder",readonly:"",value:e?e.communityname:e.propertyid?e.propertyid.communityname:"Not Available"}),t("div",{className:"flex text-xl absolute ltr:right-[14px] rtl:left-[14px] top-1/2 -translate-y-1/2  space-x-1 rtl:space-x-reverse"})]})]}),i("div",{className:"fromGroup       ",children:[t("label",{className:"block capitalize form-label  ",children:"Project Name"}),i("div",{className:"relative ",children:[t("input",{type:"text",name:"projectname",className:"  form-control py-2   ",placeholder:"Add placeholder",readonly:"",value:e?e.projectname:e.propertyid?e.propertyid.projectname:"Not Available"}),t("div",{className:"flex text-xl absolute ltr:right-[14px] rtl:left-[14px] top-1/2 -translate-y-1/2  space-x-1 rtl:space-x-reverse"})]})]}),i("div",{className:"fromGroup       ",children:[t("label",{className:"block capitalize form-label  ",children:"Building Name"}),i("div",{className:"relative ",children:[t("input",{type:"text",name:"buildingname",className:"  form-control py-2   ",placeholder:"Add placeholder",readonly:"",value:e?e.buildingname:e.propertyid?e.propertyid.buildingname:"Not Available"}),t("div",{className:"flex text-xl absolute ltr:right-[14px] rtl:left-[14px] top-1/2 -translate-y-1/2  space-x-1 rtl:space-x-reverse"})]})]}),i("div",{className:"fromGroup       ",children:[t("label",{className:"block capitalize form-label  ",children:"Floor Level"}),i("div",{className:"relative ",children:[t("input",{type:"text",name:"floor",className:"  form-control py-2   ",placeholder:"Add placeholder",readonly:"",value:e?e.floor:e.propertyid?e.propertyid.floor:"Not Available"}),t("div",{className:"flex text-xl absolute ltr:right-[14px] rtl:left-[14px] top-1/2 -translate-y-1/2  space-x-1 rtl:space-x-reverse"})]})]})]}):null}),i("div",{className:"w-[50%] col-span-3",children:[t("label",{htmlFor:" hh",className:"form-label ",children:"Enter your Purpose"}),t(L,{label:"Basic Select",className:"react-select",classNamePrefix:"select",options:k,value:k.filter(function(l){return l.value===d._id}),onChange:l=>{j({...d,_id:l==null?void 0:l.value})},styles:O,id:"hh",placeholder:"Select your purpose"}),t("div",{className:"flex items-center justify-between",children:t("div",{className:" text-danger-500 block text-sm",children:d!=null&&d._id?null:q})})]}),i("div",{className:"w-[50%] col-span-3",children:[t("label",{htmlFor:" hh",className:"form-label ",children:"Date of payment"}),t(se,{className:"form-control py-2",name:"d_o_p",value:A?A.d_o_p:e.d_o_p||e.d_o_p,onChange:l=>{te({target:{name:"d_o_p",value:l[0]}})},id:"default-picker",placeholder:"Select Date of Payment"}),t("div",{className:"flex items-center justify-between",children:t("div",{className:" text-danger-500 block text-sm",children:e.d_o_p?null:P})})]}),_.pathname===`/expenseform/${f}`?t(m,{children:i("div",{className:"w-[50%] col-span-3",children:[t(T,{name:"amount",label:"Amount",placeholder:"Enter your Amount",type:"number",register:$,value:(e.amount,e.amount),onChange:z}),t("div",{className:"flex items-center justify-between",children:t("div",{className:" text-danger-500 block text-sm",children:e.amount?null:g})})]})}):t(m,{children:i("div",{className:"w-[50%] col-span-3",children:[t(T,{name:"amount",label:"Amount",placeholder:"Enter your Amount",type:"number",register:$,value:e.amount||e.amount,onChange:z}),t("div",{className:"flex items-center justify-between",children:t("div",{className:" text-danger-500 block text-sm",children:e.amount?null:g})})]})}),i("div",{className:"w-[50%] col-span-3",children:[t("label",{htmlFor:" hh",className:"form-label ",children:"Attachment"}),t(ce,{name:"expenseAttachment",selectedFile:C,onChange:Q}),i("div",{className:"flex items-center justify-between",children:[t("div",{className:" text-danger-500 block text-sm",children:C?null:E}),e&&e.expenseAttachment?t("div",{className:"p-2",children:t("img",{src:`http://dev-rare.srp.ai/${e.expenseAttachment}`,width:150,height:150})}):null]})]}),e._id?t(m,{children:t("div",{className:"lg:col-span-2 col-span-1 relative",children:t("div",{className:"ltr:text-right rtl:text-left",children:t("div",{className:`${x===!0?"opacity-[0.7]":""}`,children:t("button",{className:"btn btn-dark  text-center",onClick:()=>Z(e),type:"button",children:"Update"})})})})}):t(m,{children:t("div",{className:"lg:col-span-2 col-span-1 relative",children:t("div",{className:"ltr:text-right rtl:text-left",children:t("div",{className:`${x===!0?"opacity-[0.7]":""}`,children:t("button",{className:"btn btn-dark  text-center",onClick:W,type:"button",children:"Submit"})})})})}),x===!0?t("div",{className:" absolute top-[0] right-[0] w-[95px] black-bg flex justify-center h-[47px] button-style items-center",children:t("div",{className:"loader-spiner"})}):null,t("div",{className:"lg:col-span-2 col-span-1 relative",children:t("div",{className:"ltr:text-right rtl:text-left",children:t("div",{className:`${x===!0?"opacity-[0.7]":""}`,children:t("button",{className:"btn btn-light  text-center",onClick:X,type:"button",children:"Cancel"})})})})]})})})})})};export{he as default};
