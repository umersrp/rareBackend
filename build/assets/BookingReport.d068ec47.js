import{R as H,j as l,F as N,r,C as he,am as ge}from"./index.0d75234e.js";import{r as b}from"./index.a246dc5d.js";import{D as xe}from"./index.esm.3c705dd8.js";import"./jspdf.es.min.2b6ef780.js";import"./html2canvas.esm.0eae2bf4.js";var a="D:\\Ahsan\\Rare\\Dev\\Rare_Frontend\\src\\pages\\owner-pages\\booking\\ReportTable.jsx";const Q=H.forwardRef(({indeterminate:f,...A},h)=>{const P=H.useRef(),o=h||P;return H.useEffect(()=>{o.current.indeterminate=f},[o,f]),l(N,{children:l("input",{type:"checkbox",ref:o,...A,className:"table-checkbox"},void 0,!1,{fileName:a,lineNumber:30,columnNumber:17},void 0)},void 0,!1)}),ye={option:(f,A)=>({...f,fontSize:"14px"})},De=({title:f,allData:A})=>{var L,M,O,G,U,V,W,q,J,K;const[h,P]=r.exports.useState([]),[o,g]=r.exports.useState([]),Z=localStorage.getItem("isAuth"),d=JSON.parse(Z),[x,w]=r.exports.useState();r.exports.useState(0),r.exports.useState(0),r.exports.useState();const[y,ee]=r.exports.useState(),[D,le]=r.exports.useState([]),[ae,T]=r.exports.useState(!1),[ie,$]=r.exports.useState(!1),[s,z]=r.exports.useState({propertyid:"",filteredDates:[]}),[te,re]=r.exports.useState({startDate:"",endDate:""}),[R,B]=r.exports.useState("");console.log("selectedProperty",s);const ne=async e=>{$(!0),B(e);const n=(await(await fetch(`http://stg.srp.ai/booking/api/reservationdate?ownerid=${d==null?void 0:d._id}&${s!=null&&s.propertyid?"propertyid="+(s==null?void 0:s.propertyid)+"&":""}checkindate=${e.startDate}&checkindate=${e.endDate}`)).json()).filter(m=>m.propertyid===s.propertyid&&m.cancelled===!1);$(!1),z({...s,filteredDates:n}),g(n)},[c,oe]=r.exports.useState([]);r.exports.useEffect(()=>{(async()=>{const t=await(await fetch(`http://stg.srp.ai/booking/pagination/pages?ownerid=${d==null?void 0:d._id}&page=0&perPage=all`)).json();t!=null&&t.booking?g([]):g([])})()},[]);const se=e=>{const i=new Set;return e.filter(t=>i.has(t._id)?!1:(i.add(t._id),!0))};r.exports.useEffect(()=>{(async()=>{try{const i=`http://stg.srp.ai/property/api/advancesearch?customerid=${d==null?void 0:d._id}&sort=descending&type=customer&page=0&perPage=all`,t=`http://stg.srp.ai/property/api/advancesearch?owner_representative_id=${d==null?void 0:d._id}&sort=descending&type=customer&page=0&perPage=all`,n=await fetch(i);if(!n.ok&&n.status!==400)throw new Error(`API 1 failed with status: ${n.status}`);const m=n.status===400?[]:await n.json(),u=await fetch(t);if(!u.ok&&u.status!==400)throw new Error(`API 2 failed with status: ${u.status}`);const p=u.status===400?[]:await u.json(),S=[...m,...p].map(v=>v._id),k=(await Promise.all(S.map(async v=>await(await fetch(`http://stg.srp.ai/booking/ownerrepresentative/pages?propertyid=${v}&page=0&perPage=all`)).json()))).flat([2]),C=se(k);P(C)}catch(i){console.error("Error fetching data:",i),setLoadingData(!1)}})()},[]),r.exports.useEffect(()=>{(async()=>{const i=h.map(async n=>{const{propertyid:m}=n;return await(await fetch(`http://stg.srp.ai/property/${m}`)).json()}),t=await Promise.all(i);oe(t)})()},[h]),r.exports.useEffect(()=>{if(T(!0),c.length){const e=[...new Map(c.map(t=>[t._id,t])).values()],i=e==null?void 0:e.map(t=>({label:t.unitnumber+" | "+t.communityname+" | "+t.projectname+" | "+t.buildingname,value:t._id}));T(!1),le(i)}},[c]),r.exports.useState(!1);const I=()=>{B(""),g([]),re({startDate:null,endDate:null})};r.exports.useEffect(()=>{var i;let e=0;for(let t=0;t<(o==null?void 0:o.length);t++){let n=parseInt((i=o[t])==null?void 0:i.nonight);e+=n}w(e)},[o==null?void 0:o.length]),r.exports.useEffect(()=>{let e=o.map(i=>Number(i.roomrenthostpayable)).reduce((i,t)=>i+t,0);ee(e)},[o==null?void 0:o.length]),r.exports.useRef(null);const me=[{Header:"Sr no",accessor:"id",Cell:({row:e,flatRows:i})=>l("span",{children:i.indexOf(e)+1},void 0,!1,{fileName:a,lineNumber:391,columnNumber:24},void 0)},{Header:"guest name",accessor:"guestname",Cell:e=>{var i,t,n,m,u;return l("span",{children:(i=e==null?void 0:e.cell)!=null&&i.value?((n=(t=e==null?void 0:e.cell)==null?void 0:t.value)==null?void 0:n.slice(0,15))+(((u=(m=e==null?void 0:e.cell)==null?void 0:m.value)==null?void 0:u.length)>15?"...":""):"Not Available"},void 0,!1,{fileName:a,lineNumber:398,columnNumber:24},void 0)}},{Header:"reservation date",accessor:"reservationdate",Cell:e=>{var i,t;return l("span",{children:(i=e==null?void 0:e.cell)!=null&&i.value?new Date((t=e==null?void 0:e.cell)==null?void 0:t.value).toDateString():"Not Available"},void 0,!1,{fileName:a,lineNumber:405,columnNumber:24},void 0)}},{Header:"Booking Ref#",accessor:"confirmationcode",Cell:e=>{var i,t,n,m;return l("div",{children:l("span",{className:"inline-flex items-center",children:l("span",{className:"text-sm text-slate-600 dark:text-slate-300 lowercase",children:(i=e==null?void 0:e.cell)!=null&&i.value?((t=e==null?void 0:e.cell)==null?void 0:t.value.slice(0,15))+(((m=(n=e==null?void 0:e.cell)==null?void 0:n.value)==null?void 0:m.length)>15?"...":""):"Not Available"},void 0,!1,{fileName:a,lineNumber:415,columnNumber:29},void 0)},void 0,!1,{fileName:a,lineNumber:414,columnNumber:25},void 0)},void 0,!1,{fileName:a,lineNumber:413,columnNumber:21},void 0)}},{Header:"checkin date",accessor:"checkindate",Cell:e=>{var i,t;return l("span",{children:(i=e==null?void 0:e.cell)!=null&&i.value?new Date((t=e==null?void 0:e.cell)==null?void 0:t.value).toDateString():"Not Available"},void 0,!1,{fileName:a,lineNumber:427,columnNumber:24},void 0)}},{Header:"checkout date",accessor:"checkoutdate",Cell:e=>{var i,t;return l("span",{children:(i=e==null?void 0:e.cell)!=null&&i.value?new Date((t=e==null?void 0:e.cell)==null?void 0:t.value).toDateString():"Not Available"},void 0,!1,{fileName:a,lineNumber:434,columnNumber:24},void 0)}},{id:"no nights stayed",Header:"no nights stayed",accessor:"nonight",Cell:e=>{var i,t;return l("span",{children:(i=e==null?void 0:e.cell)!=null&&i.value?(t=e==null?void 0:e.cell)==null?void 0:t.value:"Not Available"},void 0,!1,{fileName:a,lineNumber:442,columnNumber:24},void 0)}},{Header:"RATE PER DAY",accessor:"tourismfee",Cell:e=>{var m,u,p,_,S,j,k,C,v,F,E,Y;let i=(p=(u=(m=e==null?void 0:e.cell)==null?void 0:m.row)==null?void 0:u.original)!=null&&p.nonight?parseFloat((j=(S=(_=e==null?void 0:e.cell)==null?void 0:_.row)==null?void 0:S.original)==null?void 0:j.nonight):0,n=((v=(C=(k=e==null?void 0:e.cell)==null?void 0:k.row)==null?void 0:C.original)!=null&&v.roomrenthostpayable?parseFloat((Y=(E=(F=e==null?void 0:e.cell)==null?void 0:F.row)==null?void 0:E.original)==null?void 0:Y.roomrenthostpayable):0)/i;return l("span",{children:n?parseFloat(n).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})+" AED":"0.00"},void 0,!1,{fileName:a,lineNumber:454,columnNumber:21},void 0)}},{Header:"BOOKING AMOUNT",accessor:"roomrenthostpayable",Cell:e=>{var i,t;return l("span",{children:(i=e==null?void 0:e.cell)!=null&&i.value?parseFloat((t=e==null?void 0:e.cell)==null?void 0:t.value).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})+" AED":"0.00"},void 0,!1,{fileName:a,lineNumber:463,columnNumber:21},void 0)}}],ce=r.exports.useMemo(()=>me,[]),de=r.exports.useMemo(()=>o),ue=b.exports.useTable({columns:ce,data:de,initialState:{pageIndex:0,pageSize:50}},b.exports.useGlobalFilter,b.exports.useSortBy,b.exports.usePagination,b.exports.useRowSelect,e=>{e.visibleColumns.push(i=>[{id:"selection",Header:({getToggleAllRowsSelectedProps:t})=>l("div",{children:l(Q,{...t()},void 0,!1,{fileName:a,lineNumber:505,columnNumber:29},void 0)},void 0,!1,{fileName:a,lineNumber:504,columnNumber:25},void 0),Cell:({row:t})=>l("div",{children:l(Q,{...t.getToggleRowSelectedProps()},void 0,!1,{fileName:a,lineNumber:510,columnNumber:29},void 0)},void 0,!1,{fileName:a,lineNumber:509,columnNumber:25},void 0)},...i])}),{getTableProps:Ne,getTableBodyProps:ve,headerGroups:fe,footerGroups:Se,page:pe,nextPage:ke,previousPage:Ce,canNextPage:Ae,canPreviousPage:Pe,pageOptions:Re,state:_e,gotoPage:je,pageCount:Fe,setPageSize:Ee,setGlobalFilter:He,prepareRow:be}=ue;return l(N,{children:l("div",{className:"xl:col-span-2 col-span-1",children:l(he,{title:"Booking Report",children:[l("div",{className:"flex flex-row-reverse"},void 0,!1,{fileName:a,lineNumber:543,columnNumber:21},void 0),l("div",{children:[l("form",{className:"lg:grid-cols-3 grid gap-5 grid-cols-1 ",children:[l("div",{className:"w-[100%] col-span-3",children:l("h4",{className:"text-base text-slate-800 dark:text-slate-300 mb-[0.5rem] mt-[0.5rem]",children:"Select Property"},void 0,!1,{fileName:a,lineNumber:552,columnNumber:37},void 0)},void 0,!1,{fileName:a,lineNumber:551,columnNumber:33},void 0),l("div",{className:"w-[100%] col-span-3",children:ae===!0?l(N,{children:l("div",{className:"flex items-center justify-center h-[100%]",children:l("svg",{className:"animate-spin ltr:-ml-1 ltr:mr-3 rtl:-mr-1 rtl:ml-3 h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[l("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"},void 0,!1,{fileName:a,lineNumber:570,columnNumber:53},void 0),l("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},void 0,!1,{fileName:a,lineNumber:578,columnNumber:53},void 0)]},void 0,!0,{fileName:a,lineNumber:564,columnNumber:49},void 0)},void 0,!1,{fileName:a,lineNumber:563,columnNumber:45},void 0)},void 0,!1):l(N,{children:l(ge,{label:"Basic Select",className:"react-select",classNamePrefix:"select",options:D,value:D&&R?D.filter(function(e){return e.value===(s==null?void 0:s.propertyid)}):D.filter(function(e){return e.value===(s==null?void 0:s.propertyid)}),placeholder:"Select and Search Property",onChange:e=>{R?I():z({propertyid:e==null?void 0:e.value,propertyname:e==null?void 0:e.label},"select box")},styles:ye,id:"hh"},void 0,!1,{fileName:a,lineNumber:588,columnNumber:41},void 0)},void 0,!1)},void 0,!1,{fileName:a,lineNumber:556,columnNumber:33},void 0)]},void 0,!0,{fileName:a,lineNumber:547,columnNumber:21},void 0),"  ",(s==null?void 0:s.propertyid)&&l(N,{children:l("div",{className:"flex justify-end mt-[25px]",children:[l("div",{className:"w-[150px]",children:l("div",{className:"date-range-custom relative",children:l(xe,{value:te,inputClassName:"input-class",containerClassName:"container-class",onChange:ne},void 0,!1,{fileName:a,lineNumber:623,columnNumber:53},void 0)},void 0,!1,{fileName:a,lineNumber:622,columnNumber:45},void 0)},void 0,!1,{fileName:a,lineNumber:621,columnNumber:37},void 0),R&&l(N,{children:l("div",{className:"flex justify-end",children:l("div",{className:"w-[90px]",children:l("div",{className:"date-range-custom relative",children:l("button",{className:"btn btn-dark text-white  text-center",onClick:I,children:"Reset"},void 0,!1,{fileName:a,lineNumber:637,columnNumber:45},void 0)},void 0,!1,{fileName:a,lineNumber:636,columnNumber:45},void 0)},void 0,!1,{fileName:a,lineNumber:635,columnNumber:41},void 0)},void 0,!1,{fileName:a,lineNumber:634,columnNumber:33},void 0)},void 0,!1)]},void 0,!0,{fileName:a,lineNumber:620,columnNumber:33},void 0)},void 0,!1)]},void 0,!0,{fileName:a,lineNumber:546,columnNumber:21},void 0),ie===!0?l(N,{children:l("div",{className:"flex items-center justify-center h-[100%]",children:l("svg",{className:"animate-spin ltr:-ml-1 ltr:mr-3 rtl:-mr-1 rtl:ml-3 h-60 w-60",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[l("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"},void 0,!1,{fileName:a,lineNumber:686,columnNumber:53},void 0),l("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},void 0,!1,{fileName:a,lineNumber:694,columnNumber:53},void 0)]},void 0,!0,{fileName:a,lineNumber:680,columnNumber:49},void 0)},void 0,!1,{fileName:a,lineNumber:679,columnNumber:44},void 0)},void 0,!1):l("div",{className:"overflow-x-auto -mx-6",children:l("div",{className:"inline-block min-w-full align-middle",children:l("div",{className:"overflow-hidden ",children:o&&o.length>0&&o?l(N,{children:[" ",l("div",{className:"mt-[25px] p-8",children:[l("div",{className:"flex gap-x-[10px]",children:[l("p",{className:"font-semibold",children:"Landlord Name: "},void 0,!1,{fileName:a,lineNumber:716,columnNumber:65},void 0),l("p",{className:"capitalize",children:(L=c[0])!=null&&L.owner_name?(M=c[0])==null?void 0:M.owner_name:"Not Avaiable"},void 0,!1,{fileName:a,lineNumber:717,columnNumber:65},void 0)]},void 0,!0,{fileName:a,lineNumber:715,columnNumber:61},void 0),l("div",{className:"flex gap-x-[10px]",children:[l("p",{className:"font-semibold",children:"Community Name: "},void 0,!1,{fileName:a,lineNumber:720,columnNumber:65},void 0),l("p",{className:"capitalize",children:(O=c[0])!=null&&O.communityname?(G=c[0])==null?void 0:G.communityname:"Not Avaiable"},void 0,!1,{fileName:a,lineNumber:721,columnNumber:65},void 0)]},void 0,!0,{fileName:a,lineNumber:719,columnNumber:61},void 0),l("div",{className:"flex gap-x-[10px]",children:[l("p",{className:"font-semibold",children:"Project Name: "},void 0,!1,{fileName:a,lineNumber:724,columnNumber:65},void 0),l("p",{className:"capitalize",children:(U=c[0])!=null&&U.project_name?(V=c[0])==null?void 0:V.project_name:"Not Avaiable"},void 0,!1,{fileName:a,lineNumber:725,columnNumber:65},void 0)]},void 0,!0,{fileName:a,lineNumber:723,columnNumber:61},void 0),l("div",{className:"flex gap-x-[10px]",children:[l("p",{className:"font-semibold",children:"Apartment No: "},void 0,!1,{fileName:a,lineNumber:728,columnNumber:65},void 0),l("p",{className:"capitalize",children:(W=c[0])!=null&&W.unitnumber?(q=c[0])==null?void 0:q.unitnumber:"Not Avaiable"},void 0,!1,{fileName:a,lineNumber:729,columnNumber:65},void 0)]},void 0,!0,{fileName:a,lineNumber:727,columnNumber:61},void 0),l("div",{className:"flex gap-x-[10px]",children:[l("p",{className:"font-semibold",children:"Building No: "},void 0,!1,{fileName:a,lineNumber:732,columnNumber:65},void 0),l("p",{className:"capitalize",children:(J=c[0])!=null&&J.building_name?(K=c[0])==null?void 0:K.building_name:"Not Avaiable"},void 0,!1,{fileName:a,lineNumber:733,columnNumber:65},void 0)]},void 0,!0,{fileName:a,lineNumber:731,columnNumber:61},void 0)]},void 0,!0,{fileName:a,lineNumber:714,columnNumber:41},void 0)," ",l("table",{className:"min-w-full divide-y divide-slate-100 table-fixed dark:divide-slate-700",...Ne,children:[l("thead",{className:"bg-slate-200 dark:bg-slate-700",children:fe.map(e=>l("tr",{...e.getHeaderGroupProps(),children:e.headers.map(i=>l("th",{...i.getHeaderProps(i.getSortByToggleProps()),scope:"col",className:" table-th ",children:[i.render("Header"),l("span",{children:i.isSorted?i.isSortedDesc?" \u{1F53D}":" \u{1F53C}":""},void 0,!1,{fileName:a,lineNumber:753,columnNumber:69},void 0)]},void 0,!0,{fileName:a,lineNumber:745,columnNumber:65},void 0))},void 0,!1,{fileName:a,lineNumber:743,columnNumber:57},void 0))},void 0,!1,{fileName:a,lineNumber:741,columnNumber:49},void 0),l("tbody",{className:"bg-white divide-y divide-slate-100 dark:bg-slate-800 dark:divide-slate-700",...ve,children:[console.log("cccccccccccccccccc",c),pe.map(e=>(be(e),l("tr",{...e.getRowProps(),children:e.cells.map(i=>l("td",{...i.getCellProps(),className:"table-td",children:i.render("Cell")},void 0,!1,{fileName:a,lineNumber:778,columnNumber:73},void 0))},void 0,!1,{fileName:a,lineNumber:775,columnNumber:61},void 0))),l("tr",{children:[l("td",{className:"table-td",children:"TOTAL"},void 0,!1,{fileName:a,lineNumber:787,columnNumber:57},void 0),l("td",{},void 0,!1,{fileName:a,lineNumber:788,columnNumber:57},void 0),l("td",{},void 0,!1,{fileName:a,lineNumber:789,columnNumber:57},void 0),l("td",{},void 0,!1,{fileName:a,lineNumber:790,columnNumber:57},void 0),l("td",{},void 0,!1,{fileName:a,lineNumber:791,columnNumber:57},void 0),l("td",{},void 0,!1,{fileName:a,lineNumber:792,columnNumber:57},void 0),l("td",{},void 0,!1,{fileName:a,lineNumber:793,columnNumber:57},void 0),l("td",{className:"table-td",children:[x?x.toLocaleString():0," Nights"]},void 0,!0,{fileName:a,lineNumber:794,columnNumber:57},void 0),l("td",{className:"table-td",children:[y&&x?Math.abs(y/x).toLocaleString():0," AED"]},void 0,!0,{fileName:a,lineNumber:795,columnNumber:57},void 0),l("td",{className:"table-td",children:[y?y.toLocaleString():0," AED"]},void 0,!0,{fileName:a,lineNumber:796,columnNumber:57},void 0)]},void 0,!0,{fileName:a,lineNumber:786,columnNumber:53},void 0)]},void 0,!0,{fileName:a,lineNumber:765,columnNumber:49},void 0)]},void 0,!0,{fileName:a,lineNumber:737,columnNumber:45},void 0)]},void 0,!0):l(N,{children:l("div",{className:"pl-6",children:l("h6",{className:" text-base text-slate-800 dark:text-slate-300 mb-[0.5rem] mt-[0.5rem]",children:"No Property Data Found"},void 0,!1,{fileName:a,lineNumber:804,columnNumber:49},void 0)},void 0,!1,{fileName:a,lineNumber:803,columnNumber:45},void 0)},void 0,!1)},void 0,!1,{fileName:a,lineNumber:707,columnNumber:41},void 0)},void 0,!1,{fileName:a,lineNumber:706,columnNumber:37},void 0)},void 0,!1,{fileName:a,lineNumber:705,columnNumber:37},void 0)]},void 0,!0,{fileName:a,lineNumber:542,columnNumber:17},void 0)},void 0,!1,{fileName:a,lineNumber:541,columnNumber:9},void 0)},void 0,!1)};var X="D:\\Ahsan\\Rare\\Dev\\Rare_Frontend\\src\\pages\\owner-pages\\booking\\BookingReport.jsx";const Le=()=>l(N,{children:l("div",{className:" space-y-5",children:l(De,{title:"Booking Report"},void 0,!1,{fileName:X,lineNumber:9,columnNumber:17},void 0)},void 0,!1,{fileName:X,lineNumber:8,columnNumber:13},void 0)},void 0,!1);export{Le as default};
